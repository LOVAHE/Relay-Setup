/** 
Update on 2024, Jul 22
----------------------------------------------------------
Origin https://github.com/KOP-XIAO/QuantumultX/tree/master?tab=readme-ov-file
ğŸ—£ ğŸ†ƒğŸ„·ğŸ„°ğŸ„½ğŸ„ºğŸ…‚ ğŸ†ƒğŸ„¾  @KOP-XIAO @Jamie CHIEN, @M**F**, @c0lada, @Peng-YM, @vinewx, @love4taylor, @shadowdogy 

Main Functions:
1. Convert Server Subscriptions to Quantumult X format.
    - Supports V2rayN/SS(R/D)/HTTP(S)/Trojan/VLess/Quantumult(X)/Surge/Clash/Shadowrocket/Loon formats.
    - Provides optional personalization parameters for filtering, renaming, etc.

2. Rewrite & Filter conversion & selection.
    - Used to disable or modify specific rewrite/hostname/filter rules in remote references.
    - Supports Surge/Clash type rules and modules.
----------------------------------------------------------
0ï¸âƒ£ Add "#" after the subscription link and connect different parameters with "&".

  Example: "your_subscription_link#ğ—²ğ—ºğ—¼ğ—·ğ—¶=ğŸ­&ğ˜ğ—³ğ—¼=ğŸ­&ğ—¶ğ—»=ğ—›ğ—¼ğ—»ğ—´ğ—ğ—¼ğ—»ğ—´+ğ—§ğ—®ğ—¶ğ˜„ğ—®ğ—»"
  For local resource references, add parameters like "#in=xxx&out=yyy" to the first line of the resource fragment.
  Supports Chinese; replace special characters as follows:
    "+" â†’ "%2B", space â†’ "%20", "@" â†’ "%40", "&" â†’ "%26", "." â†’ ".", "," â†’ "%2C"

1ï¸âƒ£ General Parameters:

  ğğ¦ğ¨=ğŸ(-ğŸ): Add (remove) region flag to (from) the node name.
  ğ®ğğ©=ğŸ(-ğŸ), ğ­ğŸğ¨=ğŸ(-ğŸ): Force enable (disable) UDP relay or fast open.
  ğ®ğ¨ğ­=ğŸ: Enable udp-over-tcp for SS(R).
  ğœğğ«ğ­=ğŸ(-ğŸ): Enable (disable) TLS certificate verification (default disabled).
  ğœğ¬ğ¡ğš/ğ©ğ¬ğ¡ğš, ğšğ¥ğ©ğ§: TLS certificate SHA256 and ALPN parameters.
  ğ¢ğ§, ğ¨ğ®ğ­, ğ«ğğ ğğ±, ğ«ğğ ğ¨ğ®ğ­: Include, exclude, regex include, regex exclude nodes.
  ğ«ğğ§ğšğ¦ğ: Rename nodes using "oldname@newname", "prefix@", "@suffix".
  ğ«ğğ©ğ¥ğšğœğ: Regex replace fields in node names.
  ğ©ğ­ğ§/ğ§ğ©ğ­=ğŸ-ğŸ–: Replace English/numeric characters in node names with styles.
  ğğğ¥ğ«ğğ : Delete fields in node names using regex (use with caution).
  aead=-1: Disable Vmess AEAD.
  host=xxx: Modify existing hosts; add new hosts using â˜ ï¸.
  obfs=vhttp/shttp: Specify obfuscation for Shadowsocks or Vmess HTTP.
  tsession=0/1/2: Control TLS session ticket/reuse (0=disable, 1=enable, 2=disable all).
  checkurl=xxx: Specify server_check_url parameter.
  sort=1/-1/x/regex: Sort nodes by name in ascending/descending/random order or by regex.
  info=1: Enable notification for airport traffic info.
  flow=date:total:used: Subscription expiration date, total traffic, used traffic.
  Placeholders for rename/replace operations:
    $type0-7: Node types.
    $index0-8: Node indices.
    $emoji1-2: Emojis (e.g., ğŸ‡­ğŸ‡°).
    $tag: Subscription tag.
  Advanced Parameters: sfilter/srename for complex filtering/renaming using base64 encoded scripts.

2âƒ£ï¸ Rewrite/Filter Parameters:

  in, out: Include or exclude specific rewrite/filter rules.
  inh, outhn: Include or exclude hostnames.
  regex, regout: Regex include/exclude.
  policy: Specify policy groups for Surge type rule-sets.
  pset=regex1@policy1+regex2@policy2: Different policies for different keywords.
  replace: Regex replace in rewrite/filter content.
  dst=rewrite/filter: Convert modules/rule-sets to rewrite/filter.
  cdn=1: Convert GitHub script URLs to fastly.jsdelivr.net/gh.
  fcr=1/2/3: Add force-cellular/multi-interface/multi-interface-balance parameters.
  via: Add via-interface parameter.
  relay=policy: Convert node subscriptions to ip/host rules for proxy chaining.

3âƒ£ï¸ Notification Parameters:

  ntf=0/1: Disable/enable parser notifications.
  type=domain-set/rule/module/list/nodes: Forcefully specify the type if the parser cannot recognize it.
  hide=0: Disable the default method of hiding excluded rewrite/filter rules.
  profile=111: Add QuanX type configuration in remote resources using URL-Scheme.
----------------------------------------------------------
*/

/**
* In the [general] section of the QuantumultX configuration file, add:
resource_parser_url = https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/resource-parser.js
âš ï¸âš ï¸ If you see the message "No custom parser," long press the icon in the bottom right corner, then click the refresh button on the left to update the resources. Exit the app and reopen it until the parser description appears.
------------------------------
*/



let[link0,content0,subinfo]=[$resource.link,$resource.content,$resource.info],version="undefined"!=typeof $environment?Number($environment.version.split("build")[1]):0,Perror=0;const subtag=void 0!==$resource.tag?$resource.tag:"";content0=-1!=content0.indexOf("DOCTYPE html")&&-1!=link0.indexOf("github.com")?ToRaw(content0):content0;var para=/^(http|https)\:\/\//.test(link0)?link0:content0.split("\n")[0],para1=para.slice(para.indexOf("#")+1).replace(/\$type/g,"node_type_para_prefix").replace(/\$emoji/g,"node_emoji_flag_prefix").replace(/\$tag/g,"node_tag_prefix").replace(/\$index/g,"node_index_prefix"),mark0=-1!=para.indexOf("#"),Pinfo=mark0&&-1!=para1.indexOf("info=")?para1.split("info=")[1].split("&")[0]:0,ntf_flow=0;const Base64=new Base64Code,escapeRegExp=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var link1=link0.split("#")[0];const qxpng="https://raw.githubusercontent.com/crossutility/Quantumult-X/master/quantumult-x.png",subinfo_link={"open-url":"https://t.me/QuanX_API"},subinfo_link1={"open-url":link1},rwrite_link={"open-url":link1},rwhost_link={"open-url":link1},rule_link={"open-url":link1},nan_link={"open-url":link1,"media-url":qxpng},bug_link={"open-url":"https://t.me/404"},sub_link={"open-url":link1},update_link={"open-url":"https://apps.apple.com/us/app/quantumult-x/id1443988620","media-url":qxpng},plink0={"open-url":link0,"media-url":qxpng};0==version&&$notify("Please update Quantumult X\n",update_link);const ADDRes="quantumult-x:///add-resource?remote-resource=url-encoded-json";var RLink0={filter_remote:[],rewrite_remote:[],server_remote:[]};const Field={filter:"filter_remote",rewrite:"rewrite_remote",server:"server_remote"};SubFlow();var Pin0=mark0&&-1!=para1.indexOf("in=")?para1.split("in=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Pout0=mark0&&(-1!=para.indexOf("#out=")||-1!=para.indexOf("&out="))?(-1!=para.indexOf("#out=")?para.split("#out="):para.split("&out="))[1].split("&")[0].split("+").map(decodeURIComponent):null,Psfilter=mark0&&-1!=para1.indexOf("sfilter=")?Base64.decode(para1.split("sfilter=")[1].split("&")[0]):null,Preg=mark0&&-1!=para1.indexOf("regex=")?decodeURIComponent(para1.split("regex=")[1].split("&")[0]).replace(/\ï¼Œ/g,","):null,Pregout=mark0&&-1!=para1.indexOf("regout=")?decodeURIComponent(para1.split("regout=")[1].split("&")[0]).replace(/\ï¼Œ/g,","):null,Pregdel=mark0&&-1!=para1.indexOf("delreg=")?decodeURIComponent(para1.split("delreg=")[1].split("&")[0]).replace(/\ï¼Œ/g,","):null,Phin0=mark0&&-1!=para1.indexOf("inhn=")?para1.split("inhn=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Phout0=mark0&&-1!=para1.indexOf("outhn=")?para1.split("outhn=")[1].split("&")[0].split("+").map(decodeURIComponent):null,Preplace=mark0&&-1!=para1.indexOf("replace=")?para1.split("replace=")[1].split("&")[0]:null,Pemoji=mark0&&-1!=para1.indexOf("emoji=")?para1.split("emoji=")[1].split("&")[0]:null,Pdbg=mark0&&-1!=para1.indexOf("dbg=")?para1.split("dbg=")[1].split("&")[0]:null,Pudp0=mark0&&-1!=para1.indexOf("udp=")?para1.split("udp=")[1].split("&")[0]:0,Ptfo0=mark0&&-1!=para1.indexOf("tfo=")?para1.split("tfo=")[1].split("&")[0]:0,Prname=mark0&&/(^|\&)rename=/.test(para1)?para1.split(/(^|\&)rename\=/)[2].split("&")[0].split("+"):null,Psrename=mark0&&-1!=para1.indexOf("srename=")?Base64.decode(para1.split("srename=")[1].split("&")[0]):null,Prrname=mark0&&-1!=para1.indexOf("rrname=")?para1.split("rrname=")[1].split("&")[0].split("+"):null,Psuffix=mark0&&-1!=para1.indexOf("suffix=")?para1.split("suffix=")[1].split("&")[0]:0,Ppolicy=mark0&&-1!=para1.indexOf("policy=")?decodeURIComponent(para1.split("policy=")[1].split("&")[0]):"Shawn",Ppolicyset=mark0&&-1!=para1.indexOf("pset=")?decodeURIComponent(para1.split("pset=")[1].split("&")[0]):"",Pcert0=mark0&&-1!=para1.indexOf("cert=")?para1.split("cert=")[1].split("&")[0]:0,Psort0=mark0&&-1!=para1.indexOf("sort=")?para1.split("sort=")[1].split("&")[0]:0,PsortX=mark0&&-1!=para1.indexOf("sortx=")?para1.split("sortx=")[1].split("&")[0]:0,PTls13=mark0&&-1!=para1.indexOf("tls13=")?para1.split("tls13=")[1].split("&")[0]:0,Pntf0=mark0&&-1!=para1.indexOf("ntf=")?para1.split("ntf=")[1].split("&")[0]:2,Phide=mark0&&-1!=para1.indexOf("hide=")?para1.split("hide=")[1].split("&")[0]:1,Pb64=mark0&&-1!=para1.indexOf("b64=")?para1.split("b64=")[1].split("&")[0]:0,emojino=[" 0ï¸âƒ£ "," 1âƒ£ï¸ "," 2âƒ£ï¸ "," 3âƒ£ï¸ "," 4âƒ£ï¸ "," 5âƒ£ï¸ "," 6âƒ£ï¸ "," 7âƒ£ï¸ "," 8âƒ£ï¸ "," 9âƒ£ï¸ "," \uD83D\uDD1F "],pfi=mark0&&Pin0?"in="+Pin0.join(", ")+",  ":"",pfo=mark0&&Pout0?"out="+Pout0.join(", "):"",pfihn=mark0&&Phin0?"inhn="+Phin0.join(", ")+",  ":"",pfohn=mark0&&Phout0?"outhn="+Phout0.join(", "):"",Pcnt=mark0&&-1!=para1.indexOf("cnt=")?para1.split("cnt=")[1].split("&")[0]:0,Pcap=mark0&&-1!=para1.indexOf("cap=")?para1.split("cap=")[1].split("&")[0]:"",Pptn=mark0&&-1!=para1.indexOf("ptn=")?para1.split("ptn=")[1].split("&")[0]:"",Pnptn=mark0&&-1!=para1.indexOf("npt=")?para1.split("npt=")[1].split("&")[0]:"",Pcdn=mark0&&-1!=para1.indexOf("cdn=")?para1.split("cdn=")[1].split("&")[0]:"";let[flow,exptime,errornode,total]="";var Pdel=mark0&&-1!=para1.indexOf("del=")?para1.split("del=")[1].split("&")[0]:0,typeU=mark0&&-1!=para1.indexOf("type=")?para1.split("type=")[1].split("&")[0]:"",Pfcr=mark0&&-1!=para1.indexOf("fcr=")?para1.split("fcr=")[1].split("&")[0]:"",Pvia=mark0&&-1!=para1.indexOf("via=")?para1.split("via=")[1].split("&")[0]:"",Paead=mark0&&-1!=para1.indexOf("aead=")?para1.split("aead=")[1].split("&")[0]:"",Phost=mark0&&(-1!=para.indexOf("#host=")||-1!=para.indexOf("&host="))?(-1!=para.indexOf("#host=")?para.split("#host="):para.split("&host="))[1].split("&")[0]:"",Pcsha256=mark0&&-1!=para1.indexOf("csha=")&&version>=646?para1.split("csha=")[1].split("&")[0]:"",Ppsha256=mark0&&-1!=para1.indexOf("psha=")&&version>=646?para1.split("psha=")[1].split("&")[0]:"",typeQ=$resource.type?$resource.type:"unsupported",PRelay=mark0&&-1!=para1.indexOf("relay=")?decodeURIComponent(para1.split("relay=")[1].split("&")[0]):"",PUOT=mark0&&-1!=para1.indexOf("uot=")&&version>=665?para1.split("uot=")[1].split("&")[0]:"",PcheckU=mark0&&-1!=para1.indexOf("checkurl=")?decodeURIComponent(para1.split("checkurl=")[1].split("&")[0]):"";typeQ=""!=PRelay?"server":typeQ;var typec="",Pflow=mark0&&-1!=para1.indexOf("flow=")?para1.split("flow=")[1].split("&")[0]:0,PProfile=mark0&&-1!=para1.indexOf("profile=")?para1.split("profile=")[1].split("&")[0]:0,Palpn=mark0&&-1!=para1.indexOf("alpn=")&&version>=712?para1.split("alpn=")[1].split("&")[0]:"",Pobfs=mark0&&-1!=para1.indexOf("obfs=")&&version>=770?para1.split("obfs=")[1].split("&")[0]:"",Psession=mark0&&-1!=para1.indexOf("tsession=")&&version>=771?para1.split("tsession=")[1].split("&")[0]:"",RegoutList=[],ADDres="quantumult-x:///add-resource?remote-resource=url-encoded-json",RLink=`{
  "server_remote": [
    sremoteposition
  ],
  "filter_remote": [
    fremoteposition
  ],
  "rewrite_remote": [
    rremoteposition
  ]
}`,ProfileInfo={server:"",filter:"",rewrite:""};function VCheck(e){return cnts=(cnts=e.split("\n").filter(Boolean).map(e=>e.trim()).filter(e=>/^http/.test(e)).map(e=>'"'+e+'"')).join(",\n")}function Profile_Handle(){let e=content0;PProfile=9==(PProfile=8==(PProfile=1==PProfile?"001":PProfile)?"010":PProfile)?"011":PProfile,srm=e.split("[server_remote]")[1]&&"1"==String(PProfile)[0]?VCheck(e.split("[server_remote]")[1].split("[")[0]):"",frm=e.split("[filter_remote]")[1]&&"1"==String(PProfile)[1]?VCheck(e.split("[filter_remote]")[1].split("[")[0]):"",rrm=e.split("[rewrite_remote]")[1]&&"1"==String(PProfile)[2]?VCheck(e.split("[rewrite_remote]")[1].split("[")[0]):"",RLink=RLink.replace("sremoteposition",srm).replace("fremoteposition",frm).replace("rremoteposition",rrm),ADDres=ADDres.replace("url-encoded-json",encodeURIComponent(RLink))}var Finfo={};if(0!=Pflow){Pflow=Pflow.split(":");var BJson,Bdate=Date.parse(new Date(Pflow[0]))/1e3,Btotal=Pflow[1]?1073741824*Pflow[1]:0,Bused=Pflow[2]?1073741824*Pflow[2]:0,Bremain=0!=Btotal?Btotal-Bused:1;Finfo={bytes_used:Bused,bytes_remaining:Bremain,expire_date:Bdate}}var pat=[];pat[0]=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","k","r","s","t","u","v","w","x","y","z"],pat[1]=["\uD83C\uDD70","\uD83C\uDD71","\uD83C\uDD72","\uD83C\uDD73","\uD83C\uDD74","\uD83C\uDD75","\uD83C\uDD76","\uD83C\uDD77","\uD83C\uDD78","\uD83C\uDD79","\uD83C\uDD7A","\uD83C\uDD7B","\uD83C\uDD7C","\uD83C\uDD7D","\uD83C\uDD7E","\uD83C\uDD7F","\uD83C\uDD7A","\uD83C\uDD81","\uD83C\uDD82","\uD83C\uDD83","\uD83C\uDD84","\uD83C\uDD85","\uD83C\uDD86","\uD83C\uDD87","\uD83C\uDD88","\uD83C\uDD89"],pat[2]=["\uD83C\uDD30","\uD83C\uDD31","\uD83C\uDD32","\uD83C\uDD33","\uD83C\uDD34","\uD83C\uDD35","\uD83C\uDD36","\uD83C\uDD37","\uD83C\uDD38","\uD83C\uDD39","\uD83C\uDD3A","\uD83C\uDD3B","\uD83C\uDD3C","\uD83C\uDD3D","\uD83C\uDD3E","\uD83C\uDD3F","\uD83C\uDD3A","\uD83C\uDD41","\uD83C\uDD42","\uD83C\uDD43","\uD83C\uDD44","\uD83C\uDD45","\uD83C\uDD46","\uD83C\uDD47","\uD83C\uDD48","\uD83C\uDD49"],pat[3]=["\uD835\uDC00","\uD835\uDC01","\uD835\uDC02","\uD835\uDC03","\uD835\uDC04","\uD835\uDC05","\uD835\uDC06","\uD835\uDC07","\uD835\uDC08","\uD835\uDC09","\uD835\uDC0A","\uD835\uDC0B","\uD835\uDC0C","\uD835\uDC0D","\uD835\uDC0E","\uD835\uDC0F","\uD835\uDC0A","\uD835\uDC11","\uD835\uDC12","\uD835\uDC13","\uD835\uDC14","\uD835\uDC15","\uD835\uDC16","\uD835\uDC17","\uD835\uDC18","\uD835\uDC19"],pat[4]=["\uD835\uDDEE","\uD835\uDDEF","\uD835\uDDF0","\uD835\uDDF1","\uD835\uDDF2","\uD835\uDDF3","\uD835\uDDF4","\uD835\uDDF5","i","\uD835\uDDF7","\uD835\uDDF8","\uD835\uDDF9","\uD835\uDDFA","\uD835\uDDFB","\uD835\uDDFC","\uD835\uDDFD","\uD835\uDDF8","\uD835\uDDFF","\uD835\uDE00","\uD835\uDC2D","\uD835\uDE02","\uD835\uDE03","\uD835\uDE04","\uD835\uDE05","\uD835\uDE06","\uD835\uDE07"],pat[5]=["\uD835\uDD38","\uD835\uDD39","â„‚","\uD835\uDD3B","\uD835\uDD3C","\uD835\uDD3D","\uD835\uDD3E","â„","\uD835\uDD40","\uD835\uDD41","\uD835\uDD42","\uD835\uDD43","\uD835\uDD44","â„•","\uD835\uDD46","â„™","\uD835\uDD42","â„","\uD835\uDD4A","\uD835\uDD4B","\uD835\uDD4C","\uD835\uDD4D","\uD835\uDD4E","\uD835\uDD4F","\uD835\uDD50","â„¤"],pat[6]=["\uD835\uDD52","\uD835\uDD53","\uD835\uDD54","\uD835\uDD55","\uD835\uDD56","\uD835\uDD57","\uD835\uDD58","\uD835\uDD59","\uD835\uDD5A","\uD835\uDD5B","\uD835\uDD5C","\uD835\uDD5D","\uD835\uDD5E","\uD835\uDD5F","\uD835\uDD60","\uD835\uDD61","\uD835\uDD5C","\uD835\uDD63","\uD835\uDD64","\uD835\uDD65","\uD835\uDD66","\uD835\uDD67","\uD835\uDD68","\uD835\uDD69","\uD835\uDD6A","\uD835\uDD6B"],pat[7]=["áµƒ","áµ‡","á¶œ","áµˆ","áµ‰","á¶ ","áµ","Ê°","â±","Ê²","áµ","Ë¡","áµ","â¿","áµ’","áµ–","áµ’âƒ’","Ê³","Ë¢","áµ—","áµ˜","áµ›","Ê·","Ë£","Ê¸","á™†"],pat[8]=["á´¬","á´®","á’¼","á´°","á´±","á¶ ","á´³","á´´","á´µ","á´¶","á´·","á´¸","á´¹","á´º","á´¼","á´¾","á´¼Ì´","á´¿","Ë¢","áµ€","áµ","áµ›","áµ‚","Ë£","Ê¸","á™†"];var patn=[];patn[0]=["0","1","2","3","4","5","6","7","8","9"],patn[1]=["â“ª","â‘ ","â‘¡","â‘¢","â‘£","â‘¤","â‘¥","â‘¦","â‘§","â‘¨"],patn[2]=["â“ª","â¶","â·","â¸","â¹","âº","â»","â¼","â½","â¾"],patn[3]=["â“ª","â“µ","â“¶","â“·","â“¸","â“¹","â“º","â“¼","â“»","â“½"],patn[4]=["\uD835\uDFD8","\uD835\uDFD9","\uD835\uDFDA","\uD835\uDFDB","\uD835\uDFDC","\uD835\uDFDD","\uD835\uDFDE","\uD835\uDFDF","\uD835\uDFE0","\uD835\uDFE1"],patn[5]=["â°","\xb9","\xb2","\xb3","â´","âµ","â¶","â·","â¸","â¹"],patn[6]=["â‚€","â‚","â‚‚","â‚ƒ","â‚„","â‚…","â‚†","â‚‡","â‚ˆ","â‚‰"],patn[7]=["\uD835\uDFCE","\uD835\uDFCF","\uD835\uDFD0","\uD835\uDFD1","\uD835\uDFD2","\uD835\uDFD3","\uD835\uDFD4","\uD835\uDFF3","\uD835\uDFD6","\uD835\uDFD7"],patn[8]=["\uD835\uDFF6","\uD835\uDFF7","\uD835\uDFF8","\uD835\uDFF9","\uD835\uDFFA","\uD835\uDFFB","\uD835\uDFFC","\uD835\uDFFD","\uD835\uDFFE","\uD835\uDFFF"];const getValue=(e,t)=>{try{return e()}catch(s){return t}};var type0="",flag=1;function Parser(){if("web"!=(type0=Type_Check(content0))&&"wrong-field"!=type0&&"JS-0"!=type0)try{Pdbg&&$notify(link0,type0,content0),total=ResourceParse()}catch(e){0==Perror&&$notify("âŒ Error-1201","âš ï¸ Please send the subscription link for feedback.",e,bug_link)}else if("wrong-field"==type0){if(version>=670&&""!=typec){RLink0[Field[typec]].push($resource.link+", opt-parser=true, tag=Next time you add resources, you can long-press â¤ï¸ 8âƒ£ï¸");var t=ADDRes.replace(/url-encoded-json/,encodeURIComponent(JSON.stringify(RLink0)));let s={"open-url":t,"media-url":"https://shrtm.nu/obcB"};$notify("âš ï¸ è¯·ç‚¹å‡»é€šçŸ¥è·³è½¬å°è¯•æ·»åŠ åˆ°æ­£ç¡®ç±»å‹ä¸­","âŒ æ£€æµ‹ç±»å‹["+typec+"]ä¸å¡«å…¥ç±»å‹["+typeQ+"]å†²çª","å¦‚æœè·³è½¬æ·»åŠ ä»æ—§å¤±è´¥ï¼Œè¯·å‘é€é“¾æ¥åé¦ˆè§£æå™¨bot\n"+$resource.link,s)}else $notify("âŒ æ£€æµ‹ç±»å‹ã€Œ"+typec+" ã€ä¸ç›®æ ‡ç±»å‹ ã€Œ"+typeQ+" ã€å†²çª","âš ï¸ è¯·è‡ªè¡Œæ£€æŸ¥é“¾æ¥å†…å®¹ï¼Œæˆ–ç‚¹å‡»é€šçŸ¥å‘é€é“¾æ¥è¿›è¡Œåé¦ˆ",$resource.link,bug_link);total=""}else total="";$done({content:total})}if("undefined"!=typeof $resource&&0==PProfile)Parser(),$done({content:total,info:Finfo});else if(0!=PProfile){try{Profile_Handle()}catch(err){0==Perror&&$notify("âŒ Error-1202","âš ï¸ Please send the subscription link for feedback.è¯·ç‚¹å‡»é€šçŸ¥ï¼Œå‘é€è®¢é˜…é“¾æ¥è¿›è¡Œåé¦ˆ",err,bug_link)}openlink={"open-url":ADDres},$notify("âš ï¸è¯·å¿½ç•¥æŠ¥é”™æç¤º, ç‚¹å‡»æ­¤é€šçŸ¥è·³è½¬","æ·»åŠ é…ç½®ä¸­çš„æœ‰æ•ˆè¿œç¨‹èµ„æº\uD83D\uDC47 ["+PProfile+"]",ADDres,openlink),$done({content:total=ProfileInfo[typeQ]})}function ParseUnknown(e){try{(e=JSON.parse(e))&&$notify("âš ï¸ é“¾æ¥è¿”å›å†…å®¹å¹¶éæœ‰æ•ˆè®¢é˜…âŸ¦"+subtag+"âŸ§","â‰ï¸ è¯·è‡ªè¡Œæ£€æŸ¥åŸå§‹é“¾æ¥ï¼Œè¿”å›å†…å®¹ \uD83D\uDC47ï¸\uD83D\uDC47ï¸",JSON.stringify(e),bug_link)}catch(t){/error|block|invalid|support/.test(e.toLowerCase())?$notify("\uD83D\uDCA2 âŸ¦"+subtag+"âŸ§ è¿”å›å†…å®¹æ— æ•ˆ","\uD83D\uDE20 è¯·è‡ªè¡Œæ£€æŸ¥è®¢é˜…ï¼Œä¸è¦è·‘æ¥åé¦ˆ","è®¢é˜…è¿”å›å†…å®¹: \uD83D\uDC47 \n"+e,plink0):$notify("\uD83D\uDE2D æœªèƒ½è¯†åˆ«è®¢é˜… âŸ¦"+subtag+"âŸ§ çš„å†…å®¹","âš ï¸ å°†å°è¯•ç›´æ¥å¯¼å…¥Quantumult X \n å¦‚è®¤ä¸ºæ˜¯ BUG, è¯·ç‚¹é€šçŸ¥è·³è½¬å¹¶ [å‘é€é“¾æ¥] åé¦ˆ","è®¢é˜…è¿”å›å†…å®¹: \uD83D\uDC47 \n"+e,bug_link)}}function ResourceParse(){if("Subs-B64Encode"==type0)Pdbg&&$notify("original content","node-b64",content0),total=Subs2QX(Base64.decode(content0),Pudp0,Ptfo0,Pcert0,PTls13);else if("Subs"==type0)total=Subs2QX(content0,Pudp0,Ptfo0,Pcert0,PTls13);else if("QuanX"==type0||"Clash"==type0||"Surge"==type0)total=Subs2QX(isQuanX(content0).join("\n"),Pudp0,Ptfo0,Pcert0,PTls13);else if("sgmodule"==type0)flag=2,total=Rewrite_Filter(isQuanXRewrite(content0.split("\n")),Pin0,Pout0,Preg,Pregout),Preplace&&(total=ReplaceReg(total,Preplace)),total=total.filter((e,t)=>total.indexOf(e)==t),total=Pcdn?CDN(total):total.join("\n");else if("rewrite"==type0)flag=2,total=Rewrite_Filter(isQuanXRewrite(content0.split("\n")),Pin0,Pout0,Preg,Pregout),Preplace&&(total=ReplaceReg(total,Preplace)),total=total.filter((e,t)=>total.indexOf(e)==t),total=Pcdn?CDN(total):total.join("\n");else if("Rule"==type0)flag=3,total=Rule_Handle(content0.split("\n").map(e=>e.trim()).filter(Boolean),Pout0,Pin0).filter(Boolean),Preg&&0!=total.length&&(total=total.map(Regex).filter(Boolean),RegCheck(total,"åˆ†æµå¼•ç”¨","regex",Preg)),Pregout&&0!=total.length&&(total=total.map(RegexOut).filter(Boolean),RegCheck(total,"åˆ†æµå¼•ç”¨","regout",Pregout)),Preplace&&(total=ReplaceReg(total,Preplace)),Ppolicyset&&(total=policy_sets(total,Ppolicyset)),total=(total=total.length<100?total.filter((e,t)=>total.indexOf(e)==t):total).join("\n");else if(""==content0.trim())$notify("â€¼ï¸ å¼•ç”¨âŸ¦"+subtag+"âŸ§ è¿”å›å…§å®¹ä¸ºç©º","â‰ï¸ ç‚¹é€šçŸ¥è·³è½¬ä»¥ç¡®è®¤é“¾æ¥æ˜¯å¦å¤±æ•ˆ",para.split("#")[0],nan_link),flag=0;else if("sub-http"==type0){let e=VCheck(String(Base64.decode(content0.split("sub://")[1].split("#")[0])+", opt-parser=true, tag="+new Date().getTime()));RLink=RLink.replace("sremoteposition",e).replace("fremoteposition","").replace("rremoteposition","");let t=ADDres.replace("url-encoded-json",encodeURIComponent(RLink));openlink={"open-url":t},$notify("âš ï¸ è¯¥é“¾æ¥ä¸ºèŠ‚ç‚¹è®¢é˜…, è¯·ç‚¹å‡»æ­¤é€šçŸ¥è·³è½¬æ·»åŠ ",e,t,openlink),flag=-1,total=""}else"unknown"==type0?(ParseUnknown(content0),flag=-1):"profile"==type0?(PProfile="111",Profile_Handle(),openlink={"open-url":ADDres},$notify("âš ï¸ è¯¥é“¾æ¥ä¸ºå®Œæ•´é…ç½®æ–‡ä»¶, è¯·ç‚¹å‡»æ­¤é€šçŸ¥è·³è½¬","æ·»åŠ é…ç½®ä¸­çš„æœ‰æ•ˆè¿œç¨‹èµ„æº\uD83D\uDC47 ["+PProfile+"]",ADDres,openlink),flag=-1,total=""):"JS-0"==type0&&(total="");return 1==flag?(total=isQuanX(total.filter(Boolean).join("\n")),1==Pinfo&&0==ntf_flow&&flowcheck(total),(Pin0||Pout0)&&(total=Filter(total,Pin0,Pout0)),Preg&&(total=total.map(Regex).filter(Boolean),RegCheck(total,"èŠ‚ç‚¹è®¢é˜…","regex",Preg)),Pregout&&(total=total.map(RegexOut).filter(Boolean),RegCheck(total,"èŠ‚ç‚¹è®¢é˜…","regout",Pregout)),Psfilter&&(total=FilterScript(total,Psfilter)),Prrname&&(Prn=Prrname,total=total.map(Rename)),Pregdel&&(delreg=Pregdel,total=total.map(DelReg)),Psrename&&(total=RenameScript(total,Psrename)),Preplace&&(total=ReplaceReg(total,Preplace)),Prname&&(Prn=Prname,total=total.map(Rename),1==Pdbg&&$notify("rename","content",total)),Pemoji&&(total=emoji_handle(total,Pemoji)),total.length>0?((1==Psuffix||-1==Psuffix)&&(total=1==Psuffix?total.map(type_suffix):total.map(type_prefix)),total=total.map(type_handle).map(emoji_prefix_handle).map(tag_handle),Psort0&&(total=QXSort(total,Psort0)),total=-1!=para1.indexOf("node_index_prefix")?index_handle(total):total,total=TagCheck_QX(total).join("\n"),1==PUOT&&(total=total.split("\n").map(UOT).join("\n")),1==Pcnt&&$notify("âŸ¦"+subtag+"âŸ§è§£æåæœ€ç»ˆè¿”å›å†…å®¹","èŠ‚ç‚¹æ•°é‡: "+total.split("\n").length,total),total=""==PRelay?Base64.encode(total):ServerRelay(total.split("\n"),PRelay),1==Pflow?$done({content:total,info:{bytes_used:3073741824,bytes_remaining:2147483648,expire_date:1854193966}}):$done({content:total})):(0==Perror&&$notify("â“â“ å‹æƒ…æç¤º âŸ âŸ¦"+subtag+"âŸ§","âš ï¸âš ï¸ è§£æåæ— æœ‰æ•ˆå†…å®¹","\uD83D\uDEA5\uD83D\uDEA5 è¯·è‡ªè¡Œæ£€æŸ¥ç›¸å…³å‚æ•°, æˆ–è€…ç‚¹å‡»é€šçŸ¥è·³è½¬å¹¶å‘é€é“¾æ¥åé¦ˆ",bug_link),total=errornode,$done({content:errornode}))):0==flag?(total=errornode,$done({content:errornode})):-1==flag&&(total=content0,$done({content:content0})),1==Pcnt&&1!=flag&&$notify("è§£æåæœ€ç»ˆè¿”å›å†…å®¹","æ€»æ•°é‡ï¼š "+total.split("\n").length,total),total}function SubFlow(){if(1==Pinfo&&subinfo){var e=subinfo.replace(/ /g,"").toLowerCase(),t="æ€»æµé‡: "+(parseFloat(e.split("total=")[1].split(",")[0])/1073741824).toFixed(2)+"GB",s="å·²ç”¨æµé‡: "+((parseFloat(-1!=e.indexOf("upload")?e.split("upload=")[1].split(",")[0]:"0")+parseFloat(e.split("download=")[1].split(",")[0]))/1073741824).toFixed(2)+"GB",r="å‰©ä½™æµé‡: "+(parseFloat(e.split("total=")[1].split(",")[0])/1073741824-(parseFloat(-1!=e.indexOf("upload")?e.split("upload=")[1].split(",")[0]:"0")+parseFloat(e.split("download=")[1].split(",")[0]))/1073741824).toFixed(2)+"GB";if(-1!=e.indexOf("expire=")){var l,a=new Date(1e3*parseFloat(e.split("expire=")[1].split(",")[0])),n=a.getFullYear();a="è¿‡æœŸæ—¶é—´: "+n+"-"+(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+(10>a.getDate()?"0"+a.getDate():a.getDate())}else a="";ntf_flow=1,$notify("æµé‡ä¿¡æ¯: âŸ¦"+subtag+"âŸ§",a,t+"\n"+s+", "+r,subinfo_link)}}function flowcheck(e){for(var t=0;t<e.length;t++){var s=e[t],r=s.slice(s.indexOf("tag")),l=r.slice(r.indexOf("=")+1);-1!=s.indexOf("å‰©ä½™æµé‡")?flow=l:-1!=s.indexOf("æœŸæ—¶é—´")&&(exptime=l)}exptime=exptime||"âš ï¸ è¯¥è®¢é˜…æœªè¿”å›å¥—é¤æ—¶é—´ä¿¡æ¯",""!=(flow=flow||"âš ï¸ è¯¥è®¢é˜…æœªè¿”å›ä»»ä½•æµé‡ä¿¡æ¯")&&$notify("æµé‡ä¿¡æ¯: âŸ¦"+subtag+"âŸ§",flow,exptime,subinfo_link1)}function RegCheck(e,t,s,r){0==e.length?$notify("â€¼ï¸ "+t+"  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰æ­£åˆ™: "+s+"="+r,"âš ï¸ ç­›é€‰åå‰©ä½™é¡¹ä¸º 0ï¸âƒ£ , è¯·æ£€æŸ¥æ­£åˆ™å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link):("èŠ‚ç‚¹è®¢é˜…"!=t&&0!=Pntf0||"èŠ‚ç‚¹è®¢é˜…"==t&&1==Pntf0)&&$notify("\uD83E\uDD16 "+t+"  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰æ­£åˆ™: "+s+"="+r,"âš ï¸ ç­›é€‰åå‰©ä½™ä»¥ä¸‹"+(e.length<=10?emojino[e.length]:e.length)+"ä¸ªåŒ¹é…é¡¹ \n â¨· "+e.join("\n â¨· "),sub_link)}function Type_Check(e){var t="unknown",s=["host,","-suffix,","domain,","-keyword,","ip-cidr,","ip-cidr6,","geoip,","user-agent,","ip6-cidr,","ip-asn"],r=["shadowsocks=","trojan=","vmess=","http=","socks5="],l=["=ss,","=vmess,","=trojan,","=http,","=custom,","=https,","=shadowsocks","=shadowsocksr","=sock5","=sock5-tls"],a=["proxies:"],n=["dm1lc3M","c3NyOi8v","CnNzOi8","dHJvamFu","c3M6Ly","c3NkOi8v","c2hhZG93","aHR0cDovLw","aHR0cHM6L","CnRyb2phbjo","aHR0cD0","aHR0cCA","U1RBVFVT"],o=[" url 302"," url 307"," url reject"," url script"," url req"," url res"," url echo"," url-and-header 302"," url-and-header 307"," url-and-header reject"," url-and-header script"," url-and-header req"," url-and-header res"," url-and-header echo"],p=["ss://","vmess://","ssr://","trojan://","ssd://","\nhttps://","\nhttp://","socks://","ssocks://","vless://"],f=["[Script]","[Rule]","[URL Rewrite]","[Map Local]","\nhttp-r","script-path"],u=["[filter_local]","[filter_remote]","[server_local]","[server_remote]"],c="DOCTYPE html",_=e.replace(/ /g,"");let d=e=>-1!=_.toLowerCase().indexOf(e),$=e=>-1!=_.toLowerCase().indexOf(e.toLowerCase()),h=e=>-1!=_.toLowerCase().indexOf(e.toLowerCase()),g=e=>-1!=_.toLowerCase().indexOf(e.toLowerCase()),m=t=>-1!=e.indexOf(t),x=t=>-1!=e.indexOf(t);var v=e.split("\n");if((-1!=e.indexOf(c)||-1!=e.indexOf("doctype html"))&&link0.indexOf(!1))$notify("â€¼ï¸ è¯¥é“¾æ¥è¿”å›ä¸ºæ— æ•ˆç½‘é¡µå†…å®¹ âŸ âŸ¦"+subtag+"âŸ§","â‰ï¸ ç‚¹é€šçŸ¥è·³è½¬ä»¥ç¡®è®¤é“¾æ¥æ˜¯å¦å¤±æ•ˆ\n"+link0,"è¿”å›å†…å®¹å¦‚ä¸‹â¬‡ï¸ï¼š\n"+e,nan_link),t="web";else if("nodes"==typeU&&"server"==typeQ)t="unsupported"==typeQ||"server"==typeQ?"Subs":"wrong-field";else if(a.some($)||"clash"==typeU)t="unsupported"==typeQ||"server"==typeQ?"Clash":"wrong-field",typec="server",content0=Clash2QX(e);else if(((f.some(m)||-1!=para1.indexOf("dst=rewrite"))&&-1==para1.indexOf("dst=filter")&&-1==e.indexOf("[Proxy]")||"module"==typeU)&&"nodes"!=typeU&&"rule"!=typeU&&"filter"!=typeQ)typec="rewrite",t="unsupported"==typeQ||"rewrite"==typeQ?"sgmodule":"wrong-field";else if((/(^hostname|\nhostname)\s*\=/.test(_)||o.some(m))&&-1==para1.indexOf("dst=filter")&&-1==_.indexOf("securehostname")&&!/module|nodes|rule/.test(typeU)&&!(s.some(d)&&"filter"==typeQ)&&!("rewrite"!=typeQ&&u.some(x)))typec="rewrite",t="unsupported"==typeQ||"rewrite"==typeQ?"rewrite":"wrong-field";else if((s.some(d)&&-1==e.indexOf(c)||"rule"==typeU||-1!=para1.indexOf("dst=filter"))&&"nodes"!=typeU&&!("server"==typeQ&&(r.some($)||l.some($))))typec="filter",t="unsupported"==typeQ||"filter"==typeQ?"Rule":"wrong-field";else if("domain-set"==typeU)typec="filter-domain-set",t="unsupported"==typeQ||"filter"==typeQ?"Rule":"wrong-field",content0=Domain2Rule(content0);else if("filter"==typeQ&&-1==e.indexOf("payload:"))typec="filter-list",t="unsupported"==typeQ||"filter"==typeQ?"Rule":"wrong-field",content0=content0.split("\n").map(rule_list_handle).join("\n");else if(0==_.indexOf("sub://"))typec="sub-http",t="sub-http";else if("filter"==typeQ&&-1!=e.indexOf("payload:"))typec="Clash-Provider",t="unsupported"==typeQ||"filter"==typeQ?"Rule":"wrong-field";else if(v.length>=1&&p.some(g)&&!/\[(Proxy|filter_local)\]/.test(e))typec="server-uri",t="unsupported"==typeQ||"server"==typeQ||"uri"==typeQ?"Subs":"wrong-field";else if(-1!=_.indexOf("tag=")&&r.some($)&&!/\[(Proxy|filter_local)\]/.test(e)||"list"==typeU)typec="server-quanx",t="unsupported"==typeQ||"server"==typeQ||"uri"==typeQ?"Subs":"wrong-field";else if(-1!=e.indexOf("[Proxy]"))typec="server-surge",t="unsupported"==typeQ||"server"==typeQ||"uri"==typeQ?"Surge":"wrong-field",content0=Surge2QX(content0).join("\n");else if(l.some($)&&!/\[(Proxy|filter_local)\]/.test(e)||"list"==typeU)typec="server-surge",t="unsupported"==typeQ||"server"==typeQ||"uri"==typeQ?"Subs":"wrong-field";else if(-1!=e.indexOf("[server_local]")&&r.some($))typec="server-quanx",t="unsupported"==typeQ||"server"==typeQ||"uri"==typeQ?"Subs":"wrong-field";else if(-1!=content0.indexOf("server")&&-1!=content0.indexOf("server_port"))typec="server-sip008",t="unsupported"==typeQ||"server"==typeQ?"Subs":"wrong-field",content0=SIP2QuanX(content0);else if(n.some(h)){if(typec="server-b64",t="unsupported"==typeQ||"server"==typeQ?"Subs-B64Encode":"wrong-field",content0.split("\n").length>=2){let O=content0.split("\n")[1];Pdbg&&$notify("local","node","\ntmp:\n"+O),n.some(e=>-1!=O.toLowerCase().indexOf(e.toLowerCase()))&&(content0=O)}}else u.every(x)?(typec="profile",t="profile"):/\.js/.test(link0)?(Perror=1,$notify("âš ï¸ ä½ å¯¼å…¥çš„é“¾æ¥å†…å®¹ä¸º JS è„šæœ¬","\uD83D\uDEA5 è„šæœ¬å†…æœªæœ‰é‡å†™è§„åˆ™ï¼Œæ— æ³•è§£æä½¿ç”¨"," è¯·âš ï¸ä¸è¦âš ï¸è·‘æ¥è§£æå™¨\uD83E\uDD16ï¸åé¦ˆ \n"+link0),t="JS-0"):"server"==typeQ&&e.length>100&&(typec="server-b64-unknown",t="unsupported"==typeQ||"server"==typeQ?"Subs-B64Encode":"wrong-field");return"X"==typeU&&$notify("è¯¥é“¾æ¥åˆ¤å®šç±»å‹",t+" : "+typec,e),t}function TagCheck_QX(e){typefix={shadowsocks:["\uD835\uDC2C\uD835\uDC2C","\uD835\uDC12\uD835\uDC12","\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD82\uD83C\uDD82","â“¢â“¢","\uD83C\uDD42\uD83C\uDD42","SS"],shadowsocksr:["\uD835\uDC2C\uD835\uDC2C\uD835\uDC2B","\uD835\uDC12\uD835\uDC12\uD835\uDC11","\uD83C\uDD62\uD83C\uDD62\uD83C\uDD61","\uD83C\uDD82\uD83C\uDD82\uD83C\uDD81","â“¢â“¢â“¡","\uD83C\uDD42\uD83C\uDD42\uD83C\uDD41","SSR"],vmess:["\uD835\uDC2F\uD835\uDC26\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C","\uD835\uDC15\uD835\uDC0C\uD835\uDC04\uD835\uDC12\uD835\uDC12","\uD83C\uDD65\uD83C\uDD5C\uD83C\uDD54\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD85\uD83C\uDD7C\uD83C\uDD74\uD83C\uDD82\uD83C\uDD82","â“¥â“œâ“”â“¢â“¢","\uD83C\uDD45\uD83C\uDD3C\uD83C\uDD34\uD83C\uDD42\uD83C\uDD42","VMESS"],trojan:["\uD835\uDC2D\uD835\uDC2B\uD835\uDC28\uD835\uDC23\uD835\uDC1A\uD835\uDC27","\uD835\uDC13\uD835\uDC11\uD835\uDC0E\uD835\uDC09\uD835\uDC00\uD835\uDC0D","\uD83C\uDD63\uD83C\uDD61\uD83C\uDD5E\uD83C\uDD59\uD83C\uDD50\uD83C\uDD5D","\uD83C\uDD83\uD83C\uDD81\uD83C\uDD7E\uD83C\uDD79\uD83C\uDD70\uD83C\uDD7D","â“£â“¡â“â“™â“â“","\uD83C\uDD43\uD83C\uDD41\uD83C\uDD3E\uD83C\uDD39\uD83C\uDD30\uD83C\uDD3D","TROJAN"],http:["\uD835\uDC21\uD835\uDC2D\uD835\uDC2D\uD835\uDC29","\uD835\uDC07\uD835\uDC13\uD835\uDC13\uD835\uDC0F","\uD83C\uDD57\uD83C\uDD63\uD83C\uDD63\uD83C\uDD5F","\uD83C\uDD77\uD83C\uDD83\uD83C\uDD83\uD83C\uDD7F","â“—â“£â“£â“Ÿ","\uD83C\uDD37\uD83C\uDD43\uD83C\uDD43\uD83C\uDD3F","HTTP"],socks5:["\uD835\uDC2C\uD835\uDC28\uD835\uDDF0\uD835\uDDF8\uD835\uDC2C","\uD835\uDC12\uD835\uDC0E\uD835\uDC02\uD835\uDC0A\uD835\uDC12","\uD83C\uDD62\uD83C\uDD5E\uD83C\uDD52\uD83C\uDD5A\uD83C\uDD62","\uD83C\uDD82\uD83C\uDD7E\uD83C\uDD72\uD83C\uDD7A\uD83C\uDD82","â“¢â“„â’¸â“€â“¢","\uD83C\uDD42\uD83C\uDD3E\uD83C\uDD32\uD83C\uDD3A\uD83C\uDD42","SOCKS"],vless:["\uD835\uDC2F\uD835\uDC25\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C","\uD835\uDC15\uD835\uDC0B\uD835\uDC04\uD835\uDC12\uD835\uDC12","\uD83C\uDD65\uD83C\uDD5B\uD83C\uDD54\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD85\uD83C\uDD7B\uD83C\uDD74\uD83C\uDD82\uD83C\uDD82","â“¥â“›â“”â“¢â“¢","\uD83C\uDD45\uD83C\uDD3B\uD83C\uDD34\uD83C\uDD42\uD83C\uDD42","VLESS"]},console.log(e);for(var t=e.map(e=>e.trim()),[s,r]=[[],[]],[l,a]=[[],[]],n=0,o=0;o<t.length;o++){var p=t[o]?t[o]:"";if(typefix.shadowsocks=-1!=p.indexOf("ssr-protocol")?typefix.shadowsocksr:typefix.shadowsocks,-1!=p.replace(/ /gm,"").indexOf("tag=")){var f=p.slice(p.indexOf("tag")),u=f.slice(f.indexOf("=")+1);""==u&&(u=(tp=typefix[p.split("=")[0].trim()][3])+" | "+p.split("=")[1].split(",")[0].split(":")[0],p=p.split("tag")[0]+"tag="+u.replace("shadowsocks","ss"),l.push(u.replace("shadowsocks","ss")));for(var c=0;-1!=r.indexOf(u);)u=0==c?u+NoReplace(c+1):u.split(" ").slice(0,u.split(" ").length-2).join(" ")+NoReplace(c+1),p=1!=Pdel?p.split("tag")[0]+"tag="+u:"",c+=1;0!=c&&a.push(u),r.push(u),Pcap&&(p=Capitalize(p,Pcap),console.log(p)),(Pptn||Pnptn)&&(p=Pattern(p,Pptn,Pnptn),console.log(p)),c=0,p&&s.push(p)}}return""!=PcheckU&&(s=s.map(Add_URL)),l.length>=1&&$notify("âš ï¸ å¼•ç”¨âŸ¦"+subtag+"âŸ§ å†…æœ‰"+(n=l.length<=10?emojino[l.length]:l.length)+"ä¸ªç©ºèŠ‚ç‚¹å ","âœ… å·²å°†èŠ‚ç‚¹â€œç±»å‹+IPâ€è®¾ä¸ºèŠ‚ç‚¹å"," â¨ "+l.join("\n â¨ "),nan_link),a.length>=1&&(n=a.length<=10?emojino[a.length]:a.length,1!=Pdel&&0!=Pntf0?$notify("âš ï¸ å¼•ç”¨âŸ¦"+subtag+"âŸ§ å†…æœ‰"+n+"ä¸ªåå­—é‡å¤çš„èŠ‚ç‚¹ ","âœ… å·²æ·»åŠ æ•°å­—åŒºåˆ†, åˆ é™¤è¯·æ·»åŠ å‚æ•° del=1:"," â¨ "+a.join("\n â¨ "),nan_link):1==Pdel&&0!=Pntf0&&$notify("âš ï¸ å¼•ç”¨âŸ¦"+subtag+"âŸ§ å†…æœ‰"+n+"ä¸ªåå­—é‡å¤çš„èŠ‚ç‚¹ ","âŒï¸ å·²å…¨éƒ¨åˆ é™¤ï¼Œå¦‚éœ€ä¿ç•™è¯·å»é™¤å‚æ•° del=1:"," â¨ "+a.join("\n â¨ "),nan_link)),s}function Add_URL(e){return e&&(e=e+", server_check_url="+PcheckU),e}function NoReplace(e){if(e){for(var t=0;t<10;t++)e=e.toString().replace(RegExp(patn[0][t],"gmi"),patn[5][t]);return" "+e+" "}}function PatternN(e,t,s){if(e){if(""!=t)for(var r=0;r<26;r++)e=(e=e.toLowerCase()).replace(RegExp(pat[0][r],"gmi"),pat[t][r]);if(""!=s)for(var r=0;r<10;r++)e=e.replace(RegExp(patn[0][r],"gmi"),patn[s][r]);return console.log(e),e}}function Pattern(e,t,s){return(""!=t||""!=s)&&(e=e.split("tag=")[0]+"tag="+PatternN(e.split("tag=")[1],t,s)),e}function Capitalize(e,t){return 1==t?e=e.split("tag=")[0]+"tag="+e.split("tag=")[1].toUpperCase():-1==t?e=e.split("tag=")[0]+"tag="+e.split("tag=")[1].toLowerCase():0==t&&(e=e.split("tag=")[0]+"tag="+titleCase(e.split("tag=")[1])),e}function titleCase(e){for(var t=e.split(" "),s=0;s<t.length;s++)t[s]=t[s].slice(0,1).toUpperCase()+t[s].slice(1).toLowerCase();return t.join(" ")}function type_prefix(e){if(""!=e.trim())return(typefix={shadowsocks:"ã€Œ\uD835\uDC2C\uD835\uDC2Cã€",vmess:"ã€Œ\uD835\uDC2F\uD835\uDC26\uD835\uDC1E\uD835\uDC2C\uD835\uDC2Cã€",trojan:"ã€Œ\uD835\uDC2D\uD835\uDC2B\uD835\uDC28\uD835\uDC23\uD835\uDC1A\uD835\uDC27ã€",http:"ã€Œ\uD835\uDC21\uD835\uDC2D\uD835\uDC2D\uD835\uDC29ã€",socks5:"ã€Œ\uD835\uDC2C\uD835\uDC28\uD835\uDDF0\uD835\uDDF8\uD835\uDC2Cã€",vless:"ã€Œ\uD835\uDC2F\uD835\uDC25\uD835\uDC1E\uD835\uDC2C\uD835\uDC2Cã€"}).shadowsocks=-1!=e.indexOf("ssr-protocol")?"ã€Œ\uD835\uDC2C\uD835\uDC2C\uD835\uDC2Bã€":"ã€Œ\uD835\uDC2C\uD835\uDC2Cã€",tp=typefix[e.split("=")[0].trim()],[[e.split("tag=")[0]+"tag=",tp,e.split("tag=")[1]].join(" ")].join(" ")}function type_suffix(e){if(""!=e.trim())return(typefix={shadowsocks:"ã€Œ\uD835\uDC2C\uD835\uDC2Cã€",vmess:"ã€Œ\uD835\uDC2F\uD835\uDC26\uD835\uDC1E\uD835\uDC2C\uD835\uDC2Cã€",trojan:"ã€Œ\uD835\uDC2D\uD835\uDC2B\uD835\uDC28\uD835\uDC23\uD835\uDC1A\uD835\uDC27ã€",http:"ã€Œ\uD835\uDC21\uD835\uDC2D\uD835\uDC2D\uD835\uDC29ã€",vless:"ã€Œ\uD835\uDC2F\uD835\uDC25\uD835\uDC1E\uD835\uDC2C\uD835\uDC2Cã€"}).shadowsocks=-1!=e.indexOf("ssr-protocol")?"ã€Œ\uD835\uDC2C\uD835\uDC2C\uD835\uDC2Bã€":"ã€Œ\uD835\uDC2C\uD835\uDC2Cã€",tp=typefix[e.split("=")[0].trim()],[e,tp].join(" ")}function getnode_type(e,t){if(""!=e.trim()&&-1!=e.indexOf("tag="))return t=/^(0|1|2|3|4|5|6|7)$/.test(t)?t:8,(typefix={shadowsocks:["\uD835\uDC2C\uD835\uDC2C","\uD835\uDC12\uD835\uDC12","\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD82\uD83C\uDD82","â“¢â“¢","\uD83C\uDD42\uD83C\uDD42","\uD835\uDD4A\uD835\uDD4A","Ë¢Ë¢","SS"],shadowsocksr:["\uD835\uDC2C\uD835\uDC2C\uD835\uDC2B","\uD835\uDC12\uD835\uDC12\uD835\uDC11","\uD83C\uDD62\uD83C\uDD62\uD83C\uDD61","\uD83C\uDD82\uD83C\uDD82\uD83C\uDD81","â“¢â“¢â“¡","\uD83C\uDD42\uD83C\uDD42\uD83C\uDD41","\uD835\uDD4A\uD835\uDD4Aâ„","Ë¢Ë¢Ê³","SSR"],vmess:["\uD835\uDC2F\uD835\uDC26\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C","\uD835\uDC15\uD835\uDC0C\uD835\uDC04\uD835\uDC12\uD835\uDC12","\uD83C\uDD65\uD83C\uDD5C\uD83C\uDD54\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD85\uD83C\uDD7C\uD83C\uDD74\uD83C\uDD82\uD83C\uDD82","â“¥â“œâ“”â“¢â“¢","\uD83C\uDD45\uD83C\uDD3C\uD83C\uDD34\uD83C\uDD42\uD83C\uDD42","\uD835\uDD4D\uD835\uDD5E\uD835\uDD56\uD835\uDD64\uD835\uDD64","áµ›áµáµ‰Ë¢Ë¢","VMESS"],trojan:["\uD835\uDC2D\uD835\uDC2B\uD835\uDC28\uD835\uDC23\uD835\uDC1A\uD835\uDC27","\uD835\uDC13\uD835\uDC11\uD835\uDC0E\uD835\uDC09\uD835\uDC00\uD835\uDC0D","\uD83C\uDD63\uD83C\uDD61\uD83C\uDD5E\uD83C\uDD59\uD83C\uDD50\uD83C\uDD5D","\uD83C\uDD83\uD83C\uDD81\uD83C\uDD7E\uD83C\uDD79\uD83C\uDD70\uD83C\uDD7D","â“£â“¡â“â“™â“â“","\uD83C\uDD43\uD83C\uDD41\uD83C\uDD3E\uD83C\uDD39\uD83C\uDD30\uD83C\uDD3D","\uD835\uDD4B\uD835\uDD63\uD835\uDD60\uD835\uDD5B\uD835\uDD52\uD835\uDD5F","áµ€Ê³áµ’Ê²áµƒâ¿","TROJAN"],http:["\uD835\uDC21\uD835\uDC2D\uD835\uDC2D\uD835\uDC29","\uD835\uDC07\uD835\uDC13\uD835\uDC13\uD835\uDC0F","\uD83C\uDD57\uD83C\uDD63\uD83C\uDD63\uD83C\uDD5F","\uD83C\uDD77\uD83C\uDD83\uD83C\uDD83\uD83C\uDD7F","â“—â“£â“£â“Ÿ","\uD83C\uDD37\uD83C\uDD43\uD83C\uDD43\uD83C\uDD3F","\uD835\uDD59\uD835\uDD65\uD835\uDD65\uD835\uDD61","Ê°áµ—áµ—áµ–","HTTP"],socks5:["\uD835\uDC2C\uD835\uDC28\uD835\uDDF0\uD835\uDDF8\uD835\uDC2C","\uD835\uDC12\uD835\uDC0E\uD835\uDC02\uD835\uDC0A\uD835\uDC12","\uD83C\uDD62\uD83C\uDD5E\uD83C\uDD52\uD83C\uDD5A\uD83C\uDD62","\uD83C\uDD82\uD83C\uDD7E\uD83C\uDD72\uD83C\uDD7A\uD83C\uDD82","â“¢â“â“’â“šâ“¢","\uD83C\uDD42\uD83C\uDD3E\uD83C\uDD32\uD83C\uDD3A\uD83C\uDD42","\uD835\uDD64\uD835\uDD60\uD835\uDD54\uD835\uDD5C\uD835\uDD64","Ë¢áµ’á¶œáµË¢","SOCKS"],vless:["\uD835\uDC2F\uD835\uDC25\uD835\uDC1E\uD835\uDC2C\uD835\uDC2C","\uD835\uDC15\uD835\uDC0B\uD835\uDC04\uD835\uDC12\uD835\uDC12","\uD83C\uDD65\uD83C\uDD5B\uD83C\uDD54\uD83C\uDD62\uD83C\uDD62","\uD83C\uDD85\uD83C\uDD7B\uD83C\uDD74\uD83C\uDD82\uD83C\uDD82","â“¥â“›â“”â“¢â“¢","\uD83C\uDD45\uD83C\uDD3B\uD83C\uDD34\uD83C\uDD42\uD83C\uDD42","\uD835\uDD4D\uD835\uDD5D\uD835\uDD56\uD835\uDD64\uD835\uDD64","áµ›Ë¡áµ‰Ë¢Ë¢","VLESS"]}).shadowsocks=-1!=e.indexOf("ssr-protocol")?typefix.shadowsocksr:typefix.shadowsocks,tp=typefix[e.split("=")[0].trim()][t]}function type_handle(e){return -1!=e.indexOf("node_type_para_prefix")&&(e=e.replace(/node_type_para_prefix(\d{0,1})/g,getnode_type(e,e.split("node_type_para_prefix")[1][0]))),e}function index_handle(e){Array.from(Array((items=e.map(e=>e.trim()).filter(Boolean)).length),(e,t)=>t+1);for(var t=0;t<items.length;t++)-1!=items[t].indexOf("node_index_prefix")&&(ind=items[t].split("node_index_prefix")[1][0],ind=/^(0|1|2|3|4|5|6|7|8)$/.test(ind)?ind:0,console.log("handle index"+ind),items[t]=items[t].replace(/node_index_prefix(\d{0,1})/g,PatternN((t+1).toString(),"",ind)));return console.log(items),items}function emoji_prefix_handle(e){return -1!=e.indexOf("node_emoji_flag_prefix")&&(e=e.replace(/node_emoji_flag_prefix\d{0,1}/g,getnode_emoji(e,e.split("node_emoji_flag_prefix")[1][0]))),e}function getnode_emoji(e,t){if(t=/^(1|2)$/.test(t)?t:2,-1!=e.indexOf("tag="))return get_emoji(t,e.split("tag=")[1])[1]}function tag_handle(e){return -1!=e.indexOf("node_tag_prefix")&&(ptnn=/\d/.test(e.split("node_tag_prefix")[1][0])?e.split("node_tag_prefix")[1][0]:"",nptnn=/\d/.test(e.split("node_tag_prefix")[1][1])?e.split("node_tag_prefix")[1][1]:"",e=e.replace(/node_tag_prefix\d{0,2}/g,PatternN(subtag,ptnn,nptnn))),e}function URI_TAG(e,t){return e=e.split("tag=")[0]+"tag="+t}function ServerRelay(e,t){for(var s=[],r=0;r<e.length;r++)serverA=-1==e[r].indexOf("-host")?e[r].split("=")[1].split(":")[0].trim():e[r].split("-host")[1].split("=")[1].split(",")[0].trim(),s.push(rst="ip"==(type=/^[a-z]/.test(serverA)||/[a-z]$/.test(serverA)?"host":"ip")?"ip-cidr,"+serverA+"/32,"+t:"host-suffix,"+serverA+","+t);return s.join("\n")}function rawtest(e){if(RegExp('.*js-file-line".*?</td>',"i").test(e))return e.replace(/(.*js-file-line\"\>)(.*?)(\<\/td\>)/g,"$2").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").trim()}function ToRaw(e){e=e.split("\n").map(rawtest).filter(Boolean).join("\n");var t=link0.replace("github.com","raw.githubusercontent.com").replace("/blob","");return e?$notify("âš ï¸âš ï¸ å°†å°è¯•è§£æè¯¥èµ„æºâŸ¦"+subtag+"âŸ§","\uD83D\uDEA5 è¯·æ­£ç¡®ä½¿ç”¨GitHubçš„ raw é“¾æ¥","âŒ ä½ çš„é“¾æ¥ï¼š"+link0+"\nâœ… æ­£ç¡®é“¾æ¥ï¼š"+t,{"open-url":t}):-1!=content0.indexOf("gridcell")&&$notify("âš ï¸âš ï¸ è§£æè¯¥èµ„æº âŸ¦"+subtag+"âŸ§ å¤±è´¥","\uD83D\uDEA5 ä½ çš„é“¾æ¥ä¼¼ä¹æ˜¯ç›®å½•ï¼Œè€Œä¸æ˜¯æ–‡ä»¶","âŒ ä½ çš„é“¾æ¥ï¼š"+link0,{"open-url":link0}),e}function CDN(e){return console.log("CDN start"),e=e.join("\n").replace(/https:\/\/raw.githubusercontent.com\/(.*?)\/(.*?)\/(.*)/gmi,"https://fastly.jsdelivr.net/gh/$1/$2@$3")}function HOST_Handle(e,t){return -1==(t="host="+t+",").indexOf("â˜ ï¸")?e=e.replace(/host\s*\=(.*?)\,/,t):(t=t.split("â˜ ï¸")[0],/-host\s*\=/.test(e)?e=e.replace(/host\s*\=(.*?)\,/,t+", "):/over-tls\s*\=\s*true/.test(e)?e=e+", tls-"+t:/obfs\s*\=/.test(e)&&(e=e+", obfs-"+t)),e}function OBFS_Handle(e,t){return t="shttp"==t?"obfs=shadowsocks-http":"vhttp"==t?"obfs=vmess-http":"invalid",/obfs\s*\=\s*http/.test(e)&&"invalid"!=t&&(e=e.replace(/obfs\s*\=\s*http/,t)),e}function Session_Handle(e,t){let s=", tls-no-session-ticket=true",r=", tls-no-session-reuse=true";return 0==t?e+=s:1==t?e+=r:2==t&&(e=e+s+r),e}function SHA256_Handle(e,t,s){return(-1!=e.indexOf("over-tls=true")||-1!=e.indexOf("obfs=wss"))&&(e=e.replace(/tls-verification\s*\=\s*false(\s*)\,/,""),e=""!=t?e.replace(/tag\s*\=/,"tls-cert-sha256="+t+", tag="):e,e=""!=s?e.replace(/tag\s*\=/,"tls-pubkey-sha256="+s+", tag="):e),e}function ALPN_Handle(e,t){return(-1!=(cnti=e.replace(/\s/gmi,"")).indexOf("obfs=over-tls")||-1!=cnti.indexOf("over-tls=true"))&&(e=e+", tls-alpn="+t),e}function Mock2QXReject(e,t){return/dict/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-dict":/array/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-array":/(txt|html)/i.test(t)||null==t?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-200":/(png|jpg|gif)/i.test(t)?e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject-img":e.replace(/ /g,"").split("data=")[0].split("data-type=")[0]+" url reject"}function URX2QX(e){var t=[],s="";e=e.split("\n");for(var r=["//","#",";"],l=0;l<e.length;l++){let a=t=>0==e[l].indexOf(t);if(!r.some(a)){if("URL-REGEX"==e[l].slice(0,9))(-1!=e[l].indexOf("REJECT")||2==e[l].split(",").length)&&"*"!=e[l].replace(/ /g,"").split(",REJECT")[0].split("GEX,")[1].slice(0,1)&&(s=e[l].replace(/ /g,"").split(",REJECT")[0].split("GEX,")[1]+" url reject-200",t.push(s));else if(-1!=e[l].indexOf("data=")&&-1!=e.indexOf("[Map Local]")){let n=e[l].match(/data=.+\/(.+)"/)?e[l].match(/data=.+\/(.+)"/)[1]:null;if(!/header=".*content-type/i.test(e[l])&&/blank/i.test(n)||null==n)s=Mock2QXReject(e[l],n);else if(s=e[l].replace(/ /g,"").split("data=")[0].split("data-type=")[0].replace(/\"/g,"")+" url echo-response text/html echo-response "+e[l].split("data=")[1].split(" ")[0].replace(/\"/g,"").replace(/ /g,""),-1!=e[l].indexOf("header=")&&-1!=e[l].indexOf("Content-Type:")){let o=e[l].split("header=")[1].split("Content-Type:")[1].split(",")[0].replace(/\"/g,"");s=s.replace(/text\/html/g,o)}t.push(s)}}}return t}function SCP2QX(e){var t=[],s="",r=[" url 302"," url 307"," url reject"," url script"," url req"," url res"," url echo"," url-and-header 302"," url-and-header 307"," url-and-header reject"," url-and-header script"," url-and-header req"," url-and-header res"," url-and-header echo"];e=e.split("\n").map(e=>e.trim().replace(/\s+/g," "));for(var l=0;l<e.length;l++)try{e[l]=e[l].replace("^http","http"),"hostname"==e[l].slice(0,8)&&(hn=e[l].replace(/\%.*\%/g,"").replace(/\:\d*/g,""),t.push(hn));var a=["type=",".js","pattern=","script-path="],n=["//","#",";"];let o=t=>-1!=e[l].indexOf(t),p=t=>0==e[l].indexOf(t),f=t=>-1!=e[l].indexOf(t);if(n.some(p)||r.some(f))r.some(f)&&t.push(e[l]);else if(1==Pdbg&&$notify("rewrite-check","",e[l]),a.every(o))ptn=e[l].replace(/\s/gi,"").split("pattern=")[1].split(/\,[a-zA-Z]/)[0],js=e[l].replace(/\s/gi,"").split("script-path=")[1].split(",")[0],type=e[l].replace(/\s/gi,"").split("type=")[1].split(",")[0].trim(),subsi=e[l].replace(/ /g,"").replace(/\=true/g,"=1"),type="http-response"==type&&-1!=subsi.indexOf("requires-body=1")?"script-response-body ":"http-response"==type&&-1==subsi.indexOf("requires-body=1")?"script-response-header ":"http-request"==type&&-1!=subsi.indexOf("requires-body=1")?"script-request-body ":"http-request"==type&&-1==subsi.indexOf("requires-body=1")?"script-request-header ":"",""!=type&&(s=ptn+" url "+type+js,t.push(s));else if(/\s30(7|2)$/.test(e[l]))s=e[l].split(" ")[0]+" url "+e[l].split(" ")[2]+" "+e[l].split(" ")[1].trim(),t.push(s);else if(/\s\-\s30(2|7)\s/.test(e[l]))s=e[l].replace(" - "," url "),t.push(s);else if("header"==e[l].split(" ")[2]){var u=e[l].split(" ")[0].split(".com")[1],c=e[l].split(" ")[1].split(".com")[1];s=e[l].split(" ")[0]+" url 302 "+e[l].split(" ")[1],t.push(s)}else if("header-replace"==e[l].split(" ")[1]){console.log(e[l]);var u=e[l].split("header-replace")[1].split(":")[0].trim(),c=e[l].split("header-replace")[1].trim();s=e[l].split(" ")[0]+" url request-header (.+\\r\\n)"+u+":.+(\\r\\n) request-header $1"+c+"$2",t.push(s)}else -1!=e[l].indexOf(" _ reject")?(s=e[l].split(" ")[0]+" url reject-200",t.push(s)):-1!=e[l].indexOf(" - reject")||-1!=e[l].indexOf(" - REJECT")?(s=e[l].replace(" - "," url ").toLowerCase(),t.push(s)):2==e[l].split(" ").length&&(/\s(reject)$/.test(e[l])||/\s(reject\-)/.test(e[l]))?(s=e[l].replace(" reject"," url reject"),t.push(s)):-1!=e[l].indexOf("script-path")&&(type=e[l].replace(/\s+/g," ").split(" ")[0],js=e[l].split("script-path")[1].split("=")[1].split(",")[0],ptn=e[l].replace(/\s+/g," ").split(" ")[1],subsi=e[l].replace(/ /g,"").replace(/\=true/g,"=1"),type="http-response"==type&&-1!=subsi.indexOf("requires-body=1")?"script-response-body ":"http-response"==type&&-1==subsi.indexOf("requires-body=1")?"script-response-header ":"http-request"==type&&-1!=subsi.indexOf("requires-body=1")?"script-request-body ":"http-request"==type&&-1==subsi.indexOf("requires-body=1")?"script-request-header ":"",""!=type&&(s=ptn+" url "+type+js,t.push(s)))}catch(_){$notify("âŒï¸è§£ææ­¤æ¡æ—¶å‡ºç°é”™è¯¯ï¼Œå·²å¿½ç•¥",e[l],_)}return t}function SGMD2QX(e){var t=URX2QX(e),s=SCP2QX(e);return[...t,...s]}function Rewrite_Filter(e,t,s,r,l){for(var a=[],n=["//","#",";"],o=0,p=[],f="",u=0;u<e.length;u++){var c=(subi=e[u].trim()).replace(/ /g,"");if(""!=subi&&(-1!=subi.indexOf(" url ")||-1!=subi.indexOf(" url-and-header ")||/^hostname\=/.test(c))){let _=e=>0==subi.indexOf(e);if(n.some(_))continue;if(0==o&&0==c.indexOf("hostname="))f=Phin0||Phout0||r||l?HostNamecheck(subi,Phin0,Phout0):subi;else if(0!=c.indexOf("hostname=")){var d=Rcheck(subi,t),$=Rcheck(subi,s);1==$||0==d?p.push(subi.replace(" url "," - ").replace(" url-and-header "," - ")):0==$&&0!=d?a.push(subi):2==$&&0!=d&&a.push(subi)}}}return 0!=Pntf0&&(nowrite=p.length<=10?emojino[p.length]:p.length,no1write=a.length<=10?emojino[a.length]:a.length,Pin0&&" 0ï¸âƒ£ "!=no1write?0!=s&&$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfi+pfo,"â˜ ï¸ é‡å†™ rewrite ä¸­ä¿ç•™ä»¥ä¸‹"+no1write+"ä¸ªåŒ¹é…é¡¹:\n â¨· "+a.join("\n â¨· "),rwrite_link):p.length>0&&0!=Pout0&&$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfi+pfo,"â˜ ï¸ é‡å†™ rewrite ä¸­å·²ç¦ç”¨ä»¥ä¸‹"+nowrite+"ä¸ªåŒ¹é…é¡¹:\n â¨· "+p.join("\n â¨· "),rwrite_link)),0==a.length&&(Pin0||Pout0||Phin0||Phout0||l||r?$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfi+pfo,"âš ï¸ ç­›é€‰åå‰©ä½™rewriteè§„åˆ™æ•°ä¸º 0ï¸âƒ£ æ¡, è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link):$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ è§£æå rewrite è§„åˆ™æ•°ä¸º 0ï¸âƒ£ æ¡ ","âš ï¸ è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥å†…å®¹",nan_link)),r&&(a=a.map(Regex).filter(Boolean),RegCheck(a,"é‡å†™å¼•ç”¨","regex",r)),l&&(a=a.map(RegexOut).filter(Boolean),RegCheck(a,"é‡å†™å¼•ç”¨","regout",l)),""!=f&&a.push(f),a=1==Phide?a:[...p,...a]}function HostNamecheck(e,t,s){for(var r=e.replace(/ /g,"").split("=")[1].split(","),l=[],a=[],n=0;n<r.length;n++){dd=r[n];let o=e=>-1!=dd.indexOf(e);s&&""!=s&&s.some(o)?a.push(r[n]):t&&""!=t?t.some(o)?l.push(r[n]):a.push(r[n]):l.push(r[n])}if(0!=Pntf0&&(s||t)){var p=a.length<=10?emojino[a.length]:a.length,f=l.length<=10?emojino[l.length]:l.length;t&&" 0ï¸âƒ£ "!=f?$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfihn+pfohn,"â˜ ï¸ ä¸»æœºå hostname ä¸­å·²ä¿ç•™ä»¥ä¸‹"+f+"ä¸ªåŒ¹é…é¡¹:\n â¨· "+l.join(","),rwhost_link):a.length>0&&$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfihn+pfohn,"â˜ ï¸ ä¸»æœºå hostname ä¸­å·²åˆ é™¤ä»¥ä¸‹"+p+"ä¸ªåŒ¹é…é¡¹:\n â¨· "+a.join(","),rwhost_link)}return 0==l.length&&$notify("\uD83E\uDD16 é‡å†™å¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç­›é€‰å‚æ•°: "+pfihn+pfohn,"âš ï¸ ä¸»æœºå hostname ä¸­å‰©ä½™ 0ï¸âƒ£ é¡¹, è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link),Preg&&(l=l.map(Regex).filter(Boolean),RegCheck(l,"ä¸»æœºåhostname","regex",Preg)),Pregout&&(l=l.map(RegexOut).filter(Boolean),RegCheck(l,"ä¸»æœºåhostname","regout",Pregout)),r="hostname="+l.join(", ")}function Rcheck(e,t){if(name=e.toUpperCase(),!t)return 2;{var s=0;let r=e=>-1!=name.indexOf(e.toUpperCase());return t.some(r)&&(s=1),s}}function Rule_Handle(e,t,s){cnt=e,Tin=s,Tout=t,ply=Ppolicy;var r=[],l=["//","#",";","[","^"];if(""!=Tout&&null!=Tout){for(var a=[],n=0;n<cnt.length;n++){cc=cnt[n].replace(/^\s*\-\s/g,"").replace(/\"|\'/g,"").trim();let o=e=>-1!=cc.indexOf(e),p=e=>0==cc.toLowerCase().indexOf(e);if(Tout.some(o)&&!l.some(p))a.push("-"+Rule_Policy(cc));else if(!l.some(p)&&cc){if(dd=Rule_Policy(cc),""!=Tin&&null!=Tin){let f=e=>-1!=dd.indexOf(e);Tin.some(f)&&r.push(dd)}else r.push(dd)}}var u=a.length<=10?emojino[a.length]:a.length;if(a.length>0?0!=Pntf0&&$notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç¦ç”¨: "+Tout,"â˜ ï¸ å·²ç¦ç”¨ä»¥ä¸‹"+u+"æ¡åŒ¹é…è§„åˆ™:\n â¨· "+a.join("\n â¨· "),rule_link):$notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç¦ç”¨: "+Tout,"âš ï¸ æœªå‘ç°ä»»ä½•åŒ¹é…é¡¹, è¯·æ£€æŸ¥å‚æ•°æˆ–åŸå§‹é“¾æ¥",nan_link),""!=Tin&&null!=Tin){if(r.length>0){var c=r.length<=10?emojino[r.length]:r.length;0!=Pntf0&&$notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","âœ… ä¿ç•™:"+Tin,"\uD83C\uDFAF å·²ä¿ç•™ä»¥ä¸‹ "+c+"æ¡åŒ¹é…è§„åˆ™:\n â¨ "+r.join("\n â¨ "),rule_link)}else $notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","âœ… ä¿ç•™:"+Tin+",â›”ï¸ ç¦ç”¨: "+Tout,"âš ï¸ ç­›é€‰åå‰©ä½™è§„åˆ™æ•°ä¸º 0ï¸âƒ£ æ¡, è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link)}else 0==r.length&&$notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","â›”ï¸ ç¦ç”¨: "+Tout,"âš ï¸ ç­›é€‰åå‰©ä½™è§„åˆ™æ•°ä¸º 0ï¸âƒ£ æ¡, è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link);r=1==Phide?r:[...a,...r]}else if(""!=Tin&&null!=Tin){for(var a=[],n=0;n<cnt.length;n++){cc=cnt[n].replace(/^\s*\-\s/g,"").trim();let _=e=>0==cc.toLowerCase().indexOf(e);if(!l.some(_)&&cc){dd=Rule_Policy(cc);let d=e=>-1!=dd.indexOf(e);Tin.some(d)?r.push(dd):a.push("-"+dd)}}if(r.length>0){var $=r.length<=10?emojino[r.length]:r.length;0!=Pntf0&&$notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","âœ… ä¿ç•™:"+Tin,"\uD83C\uDFAF å·²ä¿ç•™ä»¥ä¸‹ "+$+"æ¡åŒ¹é…è§„åˆ™:\n â¨ "+r.join("\n â¨ "),rule_link)}else $notify("\uD83E\uDD16 åˆ†æµå¼•ç”¨  âŸ âŸ¦"+subtag+"âŸ§","âœ… ä¿ç•™:"+Tin,"âš ï¸ ç­›é€‰åå‰©ä½™è§„åˆ™æ•°ä¸º 0ï¸âƒ£ æ¡, è¯·æ£€æŸ¥å‚æ•°åŠåŸå§‹é“¾æ¥",nan_link);r=1==Phide?r:[...a,...r]}else r=cnt.map(Rule_Policy);return r=1==Pfcr?r.filter(Boolean).map(e=>e+", force-cellular"):r.filter(Boolean),r=2==Pfcr?r.filter(Boolean).map(e=>e+", multi-interface"):r.filter(Boolean),r=3==Pfcr?r.filter(Boolean).map(e=>e+", multi-interface-balance"):r.filter(Boolean),""!=Pvia&&(r=0==Pvia?r.filter(Boolean).map(e=>e+", via-interface=%TUN%"):r.filter(Boolean).map(e=>e+", via-interface="+Pvia)),r=r.map(e=>e.replace(/:\d*\s*,/g,",").replace(/(\'|\")/g,"").replace(/(\-suffix|\-SUFFIX)\s*\,\s*\./g,"$1, "))}function Rule_Policy(e){var t=e.replace(/^\s*\-\s/g,"").replace(/REJECT-TINYGIF/gi,"reject").replace(/REJECT-DROP/gi,"reject").trim().split("//")[0].trim().split(","),s=["//","#",";","[","/","hostname","no-ipv6","no-system","<","{","}","]","^"],r=["host","domain","ip-cidr","geoip","user-agent","ip6-cidr","ip-asn"];let l=e=>0==t[0].trim().toLowerCase().indexOf(e),a=e=>0==t[0].trim().toLowerCase().indexOf(e);if(r.some(a)&&!s.some(l)){if(3==t.length&&-1==t.indexOf("no-resolve"))ply0="Shawn"!=Ppolicy?Ppolicy:t[2],nn=t[0]+", "+t[1]+", "+ply0;else if(4==t.length&&-1!=t.indexOf("no-resolve"))nn=t.join(",").replace(",no-resolve","");else if(2==t.length)ply0="Shawn"!=Ppolicy?Ppolicy:"Shawn",nn=""!=t[1].trim()?t[0]+", "+t[1]+", "+ply0:"";else if(3==t.length&&-1!=t[2].indexOf("no-resolve"))ply0="Shawn"!=Ppolicy?Ppolicy:"Shawn",nn=t[0]+", "+t[1]+", "+ply0;else if(4==t.length&&-1!=t[3].indexOf("no-resolve"))ply0="Shawn"!=Ppolicy?Ppolicy:t[2],nn=t[0]+", "+t[1]+", "+ply0;else if(!s.some(l)&&e)return"";else return"";return -1!=t[0].indexOf("URL-REGEX")||-1!=t[0].indexOf("PROCESS")?"":nn.replace("IP-CIDR6","ip6-cidr")}return 1!=t.length||s.some(l)||""==t[0]||-1!=t[0].indexOf("payload:")||-1!=t[0].indexOf("=")||"https:"==t[0].trim()?"":rule_list_handle(t[0])}function rule_list_handle(e){var t=["//","#",";","[","!","/"];let s=t=>0==e.trim().indexOf(t),r=e=>/^\d+$/.test(e);return -1!=(e=e.split("#")[0].trim()).trim().indexOf(" ")||""==e.trim()||t.some(s)||(-1!=e.indexOf("::")&&-1!=e.indexOf("/")?(e="ip6-cidr, "+e,e="Shawn"==Ppolicy?e+", Shawn":e+", "+Ppolicy):2==e.split("/").length?(e="ip-cidr, "+e,e="Shawn"==Ppolicy?e+", Shawn":e+", "+Ppolicy):4==e.split(".").length&&e.split(".").every(r)?(e="ip-cidr, "+e+"/32",e="Shawn"==Ppolicy?e+", Shawn":e+", "+Ppolicy):-1!=e.indexOf("payload:")||(/^('|")/.test(e)?(e=e.replace(/'|"/g,"").trim(),e=/^\.|\*\./.test(e)||-1!=e.indexOf("*")?"host-wildcard, "+e.replace(/^\.|\*\./,"*."):"host-suffix, "+e.replace(/^(\+\.)/,"")):e=/\*|\+/.test(e[0])?"host-wildcard, "+e:"host-suffix, "+(e="."==e[0]?e.replace(".",""):e),e="Shawn"==Ppolicy?e+", Shawn":e+", "+Ppolicy)),e}function Domain2Rule(e){for(var t=e.split("\n"),s=["//","#",";","["],r=[],l=0;l<t.length;l++){cc=t[l].trim();let a=e=>-1!=cc.indexOf(e);!s.some(a)&&cc&&("."==cc[0]?r.push("host-suffix, "+cc.slice(1,cc.length)):r.push("host, "+cc))}return r.join("\n")}function policy_sets(e,t){for(pcnt=t.split("+"),i=0;i<pcnt.length;i++)console.log(pcnt[i]),-1!=pcnt[i].indexOf("@")&&(e=e.map(e=>filter_set(e,pcnt[i])));return e=e.filter(Boolean)}function filter_set(e,t){if(e)return paras=[t.split("@")[0],t.slice(t.split("@")[0].length+1)],console.log(t.split("@")[0].length+1,paras),e=e.split(","),reg=RegExp(paras[0]),console.log(paras,e),3==e.length&&(reg.test(e[1])||reg.test(e[2]))&&(e[2]=paras[1]),e.join(",")}function ReplaceReg(e,t){for(var s=e,r=t.replace(/\\\@/g,"atsymbol").replace(/\\\+/g,"plussymbol").split("+"),l=0;l<r.length;l++){var a=decodeURIComponent(r[l].split("@")[0]).replace(/atsymbol/g,"@").replace(/plussymbol/g,"\\+").replace(/\ï¼Œ/g,","),n=decodeURIComponent(r[l].split("@")[1]).replace(/atsymbol/g,"@").replace(/plussymbol/g,"+").replace(/\ï¼Œ/g,",");a=RegExp(a,"gmi"),s=s.map(e=>e.replace(a,n))}return s}function Subs2QX(e,t,s,r,l){Pdbg&&$notify("subs","node",e);for(var a=e.split("\n"),n=["shadowsocks=","trojan=","vmess=","http=","socks5="],o=["=ss,","=vmess,","=trojan,","=http,","=https,","=custom,","=socks5","=socks5-tls"],p=["=shadowsocks","=shadowsocksr","=vless"],f=[],u=[],c=0;c<a.length;c++){var _="";if(a[c].trim().length>3&&!/\;|\/|\#/.test(a[c][0])&&-1==a[c].indexOf(" url ")){var d=a[c].split("://")[0].trim(),$=a[c].replace(/ /g,""),h=-1!=a[c].indexOf("tag=")?a[c].split(/\&*(emoji|udp|tfo|cert|rename|replace)\=/)[0].split("tag=")[1]:"";a[c]="ssr"==d?a[c].split(/#|,|ï¼Œ/)[0]:a[c];let g=e=>-1!=$.toLowerCase().indexOf(e),m=e=>0==$.toLowerCase().indexOf(e);try{if(Pdbg&&$notify(c,d,a[c]),"vmess"!=d||-1!=a[c].indexOf("remark=")||-1!=a[c].indexOf("remarks=")||/(obfs|alterId|type|\@)\=/.test(a[c])){if("vmess"==d&&(-1!=a[c].indexOf("remark=")||-1!=a[c].indexOf("remarks=")||/(obfs|alterId|type|\@)\=/.test(a[c])))_=VR2QX(a[c],t,s,r,l),_=""!=h?URI_TAG(_,h):_;else if("socks"==d&&-1!=a[c].indexOf("remarks="))_=S5R2QX(a[c]),_=""!=h?URI_TAG(_,h):_;else if("ssocks"==d&&-1!=a[c].indexOf("remarks="))_=S5R2QX(a[c],tlsp="over-tls"),_=""!=h?URI_TAG(_,h):_;else if("ssr"==d)_=SSR2QX(a[c],t,s),_=""!=h?URI_TAG(_,h):_;else if("ss"==d)_=SS2QX(a[c],t,s),_=""!=h?URI_TAG(_,h):_;else if("ssd"==d)_=SSD2QX(a[c],t,s);else if("trojan"==d)_=TJ2QX(a[c],t,s,r,l),_=""!=h?URI_TAG(_,h):_;else if(("https"==d||"http"==d)&&-1==a[c].indexOf(",")){if(-1!=$.indexOf("@"))_=HPS2QX(a[c],s,r,l),_=""!=h?URI_TAG(_,h):_;else{var x=Base64.decode($.split(d+"://")[1].split("#")[0].split("?")[0]);x=a[c].replace($.split(d+"://")[1].split("#")[0].split("?")[0],x),_=HPS2QX(x,s,r,l),_=""!=h?URI_TAG(_,h):_}}else"vless"==d&&version<821?(Perror=1,$notify("âš ï¸ ä½ çš„ Quantumult X ç‰ˆæœ¬æš‚æœªæ”¯æŒ Vless èŠ‚ç‚¹","è¯· âš ï¸ä¸è¦âš ï¸ è·‘æ¥ è§£æå™¨\uD83E\uDD16ï¸ åé¦ˆ",a[c])):"vless"==d?_=VL2QX(a[c],t,s,r,l):n.some(m)?_=QX_TLS(isQuanX(a[c])[0],r,l):o.some(g)?_=QX_TLS(Surge2QX(a[c])[0],r,l):p.some(g)&&(_=Loon2QX(a[c]))}else{var v=Base64.decode(a[c].split("vmess://")[1]);_=-1==v.indexOf("over-tls=")?V2QX(a[c],t,s,r,l):VQ2QX(a[c],t,s,r,l),_=""!=h?URI_TAG(_,h):_}}catch(O){u.push(`<<<
Content: ${a[c]}
Error: ${O}`)}if(""!=Paead&&(_=AeadVmess(_,Paead)),""!=Phost&&(_=HOST_Handle(_,Phost)),""!=Pobfs&&(_=OBFS_Handle(_,Pobfs)),""!=Psession&&(_=Session_Handle(_,Psession)),(""!=Pcsha256||""!=Ppsha256)&&(_=SHA256_Handle(_,Pcsha256,Ppsha256)),""!=Palpn&&(_=ALPN_Handle(_,Palpn)),(_=TLS_Check(_))instanceof Array)for(var P in _)_[P]=0!=t?XUDP(_[P],t):_[P],_[P]=0!=s?XTFO(_[P],s):_[P],f.push(_[P]);else""!=_&&_&&(_=0!=t?XUDP(_,t):_,_=0!=s?XTFO(_,s):_,f.push(_))}}return u.length>0&&0!=Pntf0&&$notify(`âš ï¸ æœ‰ ${u.length} æ¡æ•°æ®è§£æå¤±è´¥, å·²å¿½ç•¥`,"å‡ºé”™å†…å®¹\uD83D\uDC47",u.join("\n")),f}function AeadVmess(e,t){let s=-1==t?"aead=false":"aead=true";return/^vmess\s*\=/.test(e)&&(/aead\s*\=/.test(e)?e=e.replace(/aead\s*\=.*\,/,s+","):((cnts=e.split(",")).push(s),e=cnts.join(", "))),e}function TLS_Check(e){return e=-1!=e.indexOf("tls-cert-sha256")||-1!=e.indexOf("tls-pubkey-sha256")?e.replace(/tls-verification\s*\=\s*false.*?\,/,"tls-verification=true,"):e}function QX_TLS(e,t,s){e=e.replace(/tag\s*\=/gm,"tag=");var r=1==t?"tls-verification=true, ":"tls-verification=false, ",l=1==s?"tls13=true, ":"";if(-1!=e.indexOf("tls-verification")?e=-1==t||1==t?e.replace(RegExp("tls-verification.*?,","gmi"),r):e:(-1!=e.indexOf("obfs=over-tls")||/over\-tls\s*\=\s*true/.test(e)||-1!=e.indexOf("obfs=wss"))&&(e=e.replace(RegExp("tag.*?=","gmi"),r+"tag=")),""!=l&&(-1!=e.indexOf("tls13")?e=e.replace(RegExp("tls13.*?,","gmi"),l):(-1!=e.indexOf("obfs=over-tls")||/over\-tls\s*\=\s*true/.test(e)||-1!=e.indexOf("obfs=wss"))&&(e=e.replace(RegExp("tag.*?=","gmi"),l+"tag="))),!/^(shadowsocks|trojan|vmess)/.test(e.trim())){if(udp="udp-relay=false, ",-1!=e.indexOf("udp-relay"))var e=e.replace(RegExp("udp-relay.*?,","gmi"),udp);else var e=e.replace(RegExp("tag.*?=","gmi"),udp+"tag=")}return e}function SIP2QuanX(e){for(i=0,ll=(e=JSON.parse(e)).length,nodes=[];i<ll;i++)node="shadowsocks= ",ip=(cnti=e[i]).server+":"+cnti.server_port,mtd="method="+cnti.method,pwd="password="+cnti.password,node+=[ip,pwd,mtd,obfs=cnti.plugin_opts?cnti.plugin_opts.replace(";",", "):"",tag="tag="+cnti.remarks].filter(Boolean).join(", "),nodes.push(node);return nodes.join("\n")}function HPS2QX(e,t,s,r){var l=-1!=e.indexOf("https://")?"https":"http",a=e.replace("https://","").replace("http://","").trim(),n=[];if(""!=a){if(-1!=a.indexOf("@"))var o="http="+a.split("@")[1].split("#")[0].split("/")[0].split("?")[0],p="username="+a.split(":")[0],f="password="+a.split("@")[0].split(":")[1];else var o=-1==a.split("#")[0].indexOf(":")?"http="+Base64.decode(a.split("#")[0].split("?")[0]):"http="+a.split("#")[0].split("?")[0];var u="tag="+decodeURIComponent(a.split("#")[1]),c="https"==l?"over-tls=true":"",_=-1!=e.indexOf("peer=")?"tls-host="+e.split("peer=")[1].split("#")[0].split("&")[0]:"",d=0!=s?"tls-verification=true":"tls-verification=false",$=1==t?"fast-open=true":"fast-open=false",h=1==r?"tls13=true":"tls13=false";""==c&&(d="",h=""),n.push(o,p,f,c,_,d,$,h,u)}return n.filter(Boolean).join(",")}function VQ2QX(e,t,s,r,l){var a,n,o=String(Base64.decode(e.replace("vmess://","").trim()).split("\0")[0]),p="",f="vmess="+o.split(",")[1].trim()+":"+o.split(",")[2].trim()+", method=aes-128-gcm, password="+o.split(",")[4].split('"')[1]+", ",u="tag="+o.split("=")[0];p=f+(-1!=e.indexOf("tfo=1")?"fast-open=true, ":"fast-open=false, ")+"udp-relay=false, ";var c="";if(-1==o.indexOf("obfs=")){c=-1!=o.indexOf("over-tls=true")?"obfs=over-tls, ":"";var _=-1!=o.indexOf("tls-host")?"obfs-host="+o.split("tls-host=")[1].split(",")[0]+", ":"";c+=_}else if(-1!=o.indexOf("obfs=ws")){c=-1!=o.indexOf("over-tls=true")?"obfs=wss, ":"obfs=ws, ";var d=-1!=o.indexOf("obfs-path=")?"obfs-uri="+o.split("obfs-path=")[1].split('"')[1]+", ":"obfs-uri=/, ";c+=d;var _=-1!=o.indexOf("obfs-header=")?"obfs-host="+o.split('obfs-header="Host:')[1].split("[")[0].trim()+", ":"";c+=_}else if(-1!=o.indexOf("obfs=http")){c="obfs=http, ";var d=-1!=o.indexOf("obfs-path=")?"obfs-uri="+o.split("obfs-path=")[1].split('"')[1]+", ":"obfs-uri=/, ";c+=d;var _=-1!=o.indexOf("obfs-header=")?"obfs-host="+o.split('obfs-header="Host:')[1].split("[")[0].trim()+", ":"";c+=_}if(-1!=c.indexOf("obfs=over-tls")||-1!=c.indexOf("obfs=wss")){c=c+(0!=r||-1!=e.indexOf("allowInsecure=1")?"tls-verification=false, ":"tls-verification=true, ")+(1==l?"tls13=true, ":"")}return p+c+u}function VR2QX(e,t,s,r,l){var a,n=String(Base64.decode(e.replace("vmess://","").split("?remark")[0].split("&remark")[0].split("?")[0]).trim()).split("\0")[0];1==Pdbg&&$notify("Shadowrocket-Vmess-URI","..",e+"\n\n"+n),-1==n.indexOf("@")&&-1!=e.indexOf("@")&&(n=e.replace("vmess://","").split("?")[0]);var o="",p="vmess="+n.split("@")[1]+", method=aes-128-gcm, ",f=n.split("@")[0].split(":")[1]?"password="+n.split("@")[0].split(":")[1]+", ":"password="+n.split("@")[0]+", ";tag=-1==e.indexOf("#")?/remarks*=/.test(e)?"tag="+decodeURIComponent(e.split(/remarks*=/)[1].split("&")[0]):"tag="+n.split("@")[1]:"tag="+e.split("#")[1];var u=-1!=e.indexOf("tfo=1")?"fast-open=true, ":"fast-open=false, ",c=0;o=p+f+u+"udp-relay=false, ";var _=-1!=e.indexOf("obfs=")?e.split("obfs=")[1].split("&")[0].trim():"none";if("none"==_)_=-1!=e.indexOf("tls=1")?"obfs=over-tls, ":"";else if("websocket"==_||"http"==_){_="http"==_?"obfs=http, ":"obfs=ws, ",_=-1!=e.indexOf("tls=1")?"obfs=wss, ":_;var d=-1!=e.indexOf("&path=")?decodeURIComponent(e.split("&path=")[1].split("&")[0]):"/";_=_+"obfs-uri="+d+", ";var $=-1!=e.indexOf("&obfsParam=")?decodeURIComponent(e.split("&obfsParam=")[1].split("&")[0].split("\n")[0]).split("\n")[0].trim():"";-1!=$.indexOf('"Host"')&&-1!=$.indexOf("{")&&($=JSON.parse($).Host),$="{}"!=$&&$?"obfs-host="+$+", ":"",_+=$}else("grpc"==_||"h2"==_)&&(Perror=1,0!=Pntf0&&$notify("âš ï¸ Quantumult X æš‚ä¸æ”¯æŒè¯¥ç±»å‹èŠ‚ç‚¹","å·²å¿½ç•¥ä»¥ä¸‹ grpc|h2 vmess èŠ‚ç‚¹",e),c=1);if(-1!=_.indexOf("obfs=over-tls")||-1!=_.indexOf("obfs=wss")){_=_+(0!=r||-1!=e.indexOf("allowInsecure=1")?"tls-verification=false, ":"tls-verification=true, ")+(1==l?"tls13=true, ":"")}return caead="aead=false, ",-1!=e.indexOf("alterId=")&&(caead=0!=Number(e.split("alterId=")[1].split("&")[0])?"aead=false, ":""),o=0==c?o+_+caead+tag:""}function S5R2QX(e,t="false"){server=Base64.decode(e.split("socks://")[1].split("#")[0].split("?")[0])+"#"+e.split("?")[1];var s=[];if(""!=server){var r="socks5="+server.split("@")[1].split("#")[0].split("/")[0],l="username="+server.split(":")[0],a="password="+server.split("@")[0].split(":")[1],n="tag="+decodeURIComponent(server.split("remarks=")[1].split("&")[0]),o="false"==t?"":"over-tls=true",p=0!=Pcert0?"tls-verification=true":"tls-verification=false";p=""==o?"":p;var f=1==Ptfo0?"fast-open=true":"fast-open=false";s.push(r,l,a,o,p,f,n)}return s.filter(Boolean).join(",")}function V2QX(e,t,s,r,l){var a=r,n=l,o=String(Base64.decode(e.replace("vmess://","")).trim()).split("\0")[0],p=[];if(""!=o){ss=JSON.parse(o),Pdbg&&$notify("Vmess-URI","",JSON.stringify(ss)),ip="vmess="+ss.add+":"+ss.port,pwd="password="+ss.id,mtd="method=aes-128-gcm";try{tag="tag="+decodeURIComponent(ss.ps)}catch(f){tag="tag="+ss.ps}udp="udp-relay=false",tfo=1==s?"fast-open=true":"fast-open=false",obfs=Fobfs(ss,a,n),caead=ss.aid&&"0"!=ss.aid?"aead=false":"aead=true",""==obfs||void 0==obfs?p.push(ip,mtd,pwd,tfo,udp,caead,tag):"NOT-SUPPORTTED"!=obfs&&p.push(ip,mtd,pwd,obfs,tfo,udp,caead,tag),QX=p.join(", ")}return QX}function Fobfs(e,t,s){var r=[];if(tcert=0==t?"tls-verification=false":"tls-verification=true",tls13=1==s?"tls13=true":"tls13=false","ws"==e.net&&"tls"==e.tls)return obfs0="obfs=wss, "+tcert+", "+tls13+", ",uri0=-1!=(uri0=e.path&&""!=e.path?"obfs-uri="+e.path:"obfs-uri=/").indexOf("uri=/")?uri0:uri0.replace("uri=","uri=/"),r.push(obfs0+(host0=e.host&&""!=e.host?"obfs-host="+e.host+", ":"")+uri0),r.join(", ");if("ws"==e.net)return obfs0="obfs=ws",uri0=-1!=(uri0=e.path&&""!=e.path?"obfs-uri="+e.path:"obfs-uri=/").indexOf("uri=/")?uri0:uri0.replace("uri=","uri=/"),r.push(obfs0,(host0=e.host&&""!=e.host?"obfs-host="+e.host+", ":"")+uri0),r.join(", ");if("tls"==e.tls&&("tcp"==e.net||"none"==e.net))return obfs0="obfs=over-tls, "+tcert+", "+tls13,uri0=-1!=(uri0=e.path&&""!=e.path?"obfs-uri="+e.path:"").indexOf("uri=/")?uri0:uri0.replace("uri=","uri=/"),r.push(obfs0+(host0=e.host&&""!=e.host?", obfs-host="+e.host:"")),r.join(", ");if(("tcp"==e.net||"none"==e.net)&&"http"==e.type)return obfs0="obfs=http",uri0=-1!=(uri0=e.path&&""!=e.path?"obfs-uri="+e.path:"obfs-uri=/").indexOf("uri=/")?uri0:uri0.replace("uri=","uri=/"),r.push(obfs0,(host0=e.host&&""!=e.host?"obfs-host="+e.host+", ":"")+uri0),r.join(", ");if("tcp"!=e.net&&"none"!=e.net&&void 0!=e.net)return Perror=1,$notify("âš ï¸ Quantumult X ä¸æ”¯æŒè¯¥ç±»å‹èŠ‚ç‚¹","vmess + "+e.net,JSON.stringify(e)),"NOT-SUPPORTTED";else if(("tcp"==e.net||"none"==e.net)&&void 0!=e.type&&"none"!=e.type&&""!=e.type&&"vmess"!=e.type)return"NOT-SUPPORTTED";else return""}function Dot2(e){return e=e?e.replace(/\\\./g,"è¿™æ˜¯ä¸ªç‚¹"):""}function ToDot(e){return e=e?e.replace(/è¿™æ˜¯ä¸ªç‚¹/g,"."):""}function Regex(e){var t=RegExp(Preg,"i");if(cnt=e,t.test(cnt))return e}function RegexOut(e){var t=RegExp(Pregout,"i");if(cnt=e,!t.test(cnt))return e;RegoutList.push(cnt)}function Scheck(e,t){if(name=e.replace(/tag\s*\=/g,"tag=").split("tag=")[1].toUpperCase(),!(t=t?t.map(Dot2):t))return 2;for(var s=0,r=0;r<t.length;r++){var l=t[r].split(".").map(ToDot);let a=e=>-1!=name.indexOf(e.toUpperCase());l.every(a)&&(s=1)}return s}function Filter(e,t,s){var r=[],l=[],a=[];e=e.filter(Boolean);for(var n=0;n<e.length;n++)0!=Scheck(e[n],t)&&1!=Scheck(e[n],s)?(r.push(e[n]),a.push(e[n].replace(/ /g,"").split("tag=")[1])):l.push(e[n].replace(/ /g,"").split("tag=")[1]);var o=l.length<=10?emojino[l.length]:l.length,p=r.length<=10?emojino[r.length]:r.length;return 1==Pntf0&&l.length>=1?t&&p>0?$notify("\uD83D\uDC65 å¼•ç”¨âŸ¦"+subtag+"âŸ§ å¼€å§‹èŠ‚ç‚¹ç­›é€‰","\uD83D\uDD79 ç­›é€‰å…³é”®å­—: "+pfi+pfo,"â˜ ï¸ å·²ä¿ç•™ä»¥ä¸‹ "+p+"ä¸ªèŠ‚ç‚¹\n"+a.join(", "),sub_link):s&&o>0&&$notify("\uD83D\uDC65 å¼•ç”¨âŸ¦"+subtag+"âŸ§ å¼€å§‹èŠ‚ç‚¹ç­›é€‰","\uD83D\uDD79 ç­›é€‰å…³é”®å­—: "+pfi+pfo,"â˜ ï¸ å·²åˆ é™¤ä»¥ä¸‹ "+o+"ä¸ªèŠ‚ç‚¹\n"+l.join(", "),sub_link):(0==p||null==p)&&$notify("â€¼ï¸ âŸ¦"+subtag+"âŸ§ç­›é€‰åèŠ‚ç‚¹æ•°ä¸º0ï¸âƒ£","âš ï¸ è¯·è‡ªè¡Œæ£€æŸ¥åŸå§‹é“¾æ¥ä»¥åŠç­›é€‰å‚æ•°",link0,sub_link),r}function FilterScript(servers,script){$notify("\uD83E\uDD16 å¯ç”¨è„šæœ¬è¿›è¡Œç­›é€‰","",script);try{let $=Tools();eval(script);let nodes=Tools().getNodeInfo(servers),IN=filter(nodes),res=servers.filter((e,t)=>IN[t]);return 0===res.length&&$notify("â€¼ï¸ âŸ¦"+subtag+"âŸ§ç­›é€‰åèŠ‚ç‚¹æ•°ä¸º0ï¸âƒ£","âš ï¸ è¯·è‡ªè¡Œæ£€æŸ¥åŸå§‹é“¾æ¥ä»¥åŠç­›é€‰å‚æ•°",link0,sub_link),res}catch(err){return $notify("âŒ è„šæœ¬ç­›é€‰å‡ºç°é”™è¯¯","",err),servers}}function SSR2QX(e,t,s){var r=[],l=Base64.decode(e.split("ssr://")[1].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],a="",n="";return 1==Pdbg&&$notify("ssr","content",l),l.split(":").length<=8?(type="shadowsocks=",ip=l.split(":")[0]+":"+l.split(":")[1],pwd="password="+Base64.decode(l.split("/?")[0].split(":")[5].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],mtd="method="+l.split(":")[3],obfs="plain"!=l.split(":")[4]?"obfs="+l.split(":")[4]:"",ssrp="origin"!=l.split(":")[2]?"ssr-protocol="+l.split(":")[2]:"",-1!=l.indexOf("obfsparam=")&&""!=obfs&&(a=""!=l.split("obfsparam=")[1].split("&")[0]?"obfs-host="+Base64.decode(l.split("obfsparam=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split(",")[0].split("\0")[0]:""),-1!=l.indexOf("protoparam=")&&(n=""!=l.split("protoparam=")[1].split("&")[0]?"ssr-protocol-param="+Base64.decode(l.split("protoparam=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split(",")[0].split("\0")[0]:""),tag="tag="+Base64.decode(l.split("remarks=")[1].split("&")[0].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0],pudp=1==t?"udp-relay=true":"udp-relay=false",r.push(type+ip,pwd,mtd,obfs,a,n,ssrp,pudp,ptfo=1==s?"fast-open=true":"fast-open=false",tag),QX=r.filter(Boolean).join(", ")):QX="",QX}function VL2QX(e,t,s,r,l){var a=[],n=e.split("vless://")[1];return type="vless=",mtd="method=none",obfs="",thost="",-1==n.indexOf("remarks=")&&-1!=n.indexOf("@")?(typeU="URI",ip=n.split("@")[1].split("encry")[0].split("?")[0],pwd=n.split("@")[0]?"password="+n.split("@")[0]:"",pcert=-1!=n.indexOf("allowInsecure=0")?"tls-verification=true":"tls-verification=false",thost=-1!=n.indexOf("sni=")?"tls-host="+n.split("sni=")[1].split(/&|#/)[0]:"",thost=-1!=n.indexOf("peer=")?"tls-host="+n.split("peer=")[1].split(/&|#/)[0]:thost,tag=-1!=n.indexOf("#")?"tag="+decodeURIComponent(n.split("#").slice(-1)[0]):"tag= [vless]"+ip):(typeU="SR-URI",tag=-1!=n.indexOf("remarks=")?"tag="+decodeURIComponent(n.split("remarks=")[1].split("&")[0]):"tag= [vless]"+ip,ip=(b64part=Base64.decode(n.split("?")[0])).split("@")[1],pwd="password="+b64part.split("@")[0].split(":")[1]),puri="",pudp=1==t||-1!=n.indexOf("udp=1")?"udp-relay=true":"udp-relay=false",ptfo=1==s||-1!=n.indexOf("tfo=1")?"fast-open=true":"fast-open=false","SR-URI"==typeU?(-1!=n.indexOf("obfs=none")&&-1==n.indexOf("tls=1")?obfs="":-1!=n.indexOf("obfs=none")&&-1!=n.indexOf("tls=1")?obfs="obfs=over-tls":-1!=n.indexOf("obfs=http")?obfs="obfs=http":-1!=n.indexOf("obfs=websocket")&&(obfs=-1!=n.indexOf("tls=1")?"obfs=wss":"obfs=ws"),thost=-1==n.indexOf("obfsParam=")?thost:"obfs-host="+decodeURIComponent(n.split("obfsParam=")[1].split("&")[0].split("#")[0]),puri=-1==n.indexOf("path=")?puri:"obfs-uri="+decodeURIComponent(n.split("path=")[1].split("&")[0].split("#")[0])):-1!=n.indexOf("&type=ws")||-1!=n.indexOf("?type=ws")||-1!=n.indexOf("type=http")||-1!=n.indexOf("security=tls")?(-1!=n.indexOf("type=http")?obfs="obfs=http":-1!=n.indexOf("type=ws")?obfs=-1!=n.indexOf("security=tls")?"obfs=wss":"obfs=ws":-1!=n.indexOf("security=tls")&&(obfs="obfs=over-tls"),thost=-1==n.indexOf("&host=")?thost:"obfs-host="+decodeURIComponent(n.split("&host=")[1].split("&")[0].split("#")[0]),puri=-1==n.indexOf("&path=")?puri:"obfs-uri="+decodeURIComponent(n.split("&path=")[1].split("&")[0].split("#")[0])):-1!=n.indexOf("security=xtls")?type="NS":-1!=n.indexOf("type=")&&-1==n.indexOf("type=tcp")&&(type="NS"),"obfs=wss"==obfs&&"obfs=over-tls"==obfs?(ptls13=1==l?"tls13=true":"tls13=false",0==r?pcert="tls-verification=false":1==r&&(pcert="tls-verification=true")):(pcert="",ptls13=""),a.push(type+ip,pwd,mtd,obfs,pcert,thost,puri,pudp,ptfo,tag),QX="NS"!=type?a.filter(Boolean).join(", "):""}function TJ2QX(e,t,s,r,l){var a=[],n=e.split("trojan://")[1];return type="trojan=",ip=-1!=n.indexOf(":443")?n.split("@")[1].split(":443")[0]+":443":n.split("@")[1].split("?")[0].split("\n")[0].split("#")[0].trim(),pwd=n.split("@")[0]?"password="+decodeURIComponent(n.split("@")[0]):"",obfs="over-tls=true",pcert=-1!=n.indexOf("allowInsecure=0")?"tls-verification=true":"tls-verification=false",thost=-1!=n.indexOf("sni=")?"tls-host="+n.split("sni=")[1].split(/&|#/)[0]:"",thost=-1!=n.indexOf("peer=")?"tls-host="+n.split("peer=")[1].split(/&|#/)[0]:thost,ptls13=1==l?"tls13=true":"tls13=false",puri="",0==r?pcert="tls-verification=false":1==r&&(pcert="tls-verification=true"),pudp=1==t||-1!=n.indexOf("udp=1")?"udp-relay=true":"udp-relay=false",ptfo=1==s||-1!=n.indexOf("tfo=1")?"fast-open=true":"fast-open=false",tag=-1!=n.indexOf("#")?"tag="+decodeURIComponent(n.split("#").slice(-1)[0]):"tag= [trojan]"+ip,-1!=n.indexOf("&plugin=obfs-local")?(obfs=-1!=n.indexOf("obfs=websocket")?"obfs=wss":obfs,thost=-1==n.indexOf("obfs-host=")?thost:"obfs-host="+decodeURIComponent(n.split("obfs-host=")[1].split(";")[0].split("#")[0]),puri=-1==n.indexOf("obfs-uri=")?puri:"obfs-uri="+decodeURIComponent(n.split("obfs-uri=")[1].split(";")[0].split("#")[0])):(-1!=n.indexOf("&type=ws")||-1!=n.indexOf("?type=ws"))&&(obfs=-1!=n.indexOf("security=tls")?"obfs=wss":obfs,thost=-1==n.indexOf("&host=")?thost:"obfs-host="+decodeURIComponent(n.split("&host=")[1].split("&")[0].split("#")[0]),puri=-1==n.indexOf("&path=")?puri:"obfs-uri="+decodeURIComponent(n.split("&path=")[1].split("&")[0].split("#")[0])),a.push(type+ip,pwd,obfs,pcert,thost,puri,pudp,ptfo,tag),QX=a.filter(Boolean).join(", ")}function joinx(e,t){return e+":"+t}function SS2QX(e,t,s){var r=[],l=e.split("ss://")[1];if(QX="",l.split(":").length<=10){type="shadowsocks=";let a=l.split("#")[0];if(-1!=a.indexOf("@")&&-1!=a.indexOf(":"))ip=l.split("@")[1].split("#")[0].split("/")[0].split("?")[0],pwdmtd=Base64.decode(l.split("@")[0].replace(/-/g,"+").replace(/_/g,"/")).split("\0")[0].split(":");else if(-1==a.indexOf("?")){var n=Base64.decode(l.split("#")[0].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]);ip=n.split("@")[1].split("#")[0].split("/")[0],pwdmtd=n.split("@")[0].split(":")}else if(-1!=a.indexOf("?")){var n=Base64.decode(l.split("#")[0].split("?")[0].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]),o=Base64.decode(l.split("#")[0].split("?")[1].split("=")[1].replace(/-/g,"+").replace(/_/g,"/").split("\0")[0]);ip=n.split("@")[1].split("#")[0].split("/")[0],pwdmtd=n.split("@")[0].split(":")}mtd="method="+pwdmtd[0],pwdmtd.splice(0,1),pwd="password="+pwdmtd.reduce(joinx),-1==a.indexOf("v2ray-plugin")&&-1==a.indexOf("plugin=v2ray")?(obfs=null!=l.split("obfs%3D")[1]?", obfs="+l.split("obfs%3D")[1].split("%3B")[0].split("#")[0]:"",obfshost=null!=l.split("obfs-host%3D")[1]?", obfs-host="+l.split("obfs-host%3D")[1].split("&")[0].split("#")[0]:""):void 0!=o?(obfs=(o=JSON.parse(o)).tls?", obfs=wss":", obfs=ws",obfshost=o.host?", obfs-host="+o.host+", tls-verification=false":""):-1!=a.indexOf("v2ray-plugin")?(obfs=-1!=(o=decodeURIComponent(a.split("v2ray-plugin")[1])).indexOf("tls")?", obfs=wss":", obfs=ws",obfshost="obfs-host="!=(obfshost=-1!=o.indexOf("host=")?", obfs-host="+o.split("host=")[1].split(";")[0].split("#")[0].trim():"")?obfshost:""):-1!=a.indexOf("plugin=v2ray")&&(obfs=-1!=(o=decodeURIComponent(a.split("plugin=v2ray")[1])).indexOf("tls")?", obfs=wss":", obfs=ws",obfshost="obfs-host="!=(obfshost=-1!=o.indexOf("host=")?", obfs-host="+o.split("host=")[1].split(";")[0].split("#")[0].trim():"")?obfshost:""),tag="undefined"!=decodeURIComponent(l.split("#")[1])?"tag="+decodeURIComponent(l.split("#")[1]):"tag="+ip,pudp=1==t?"udp-relay=true":"udp-relay=false",ptfo=1==s?"fast-open=true":"fast-open=false",r.push(type+ip,pwd,mtd+obfs+obfshost,pudp,ptfo,tag),QX=r.join(", "),1==Pdbg&&$notify("SS","content",l+"\n"+QX)}return QX}function SSD2QX(e,t,s){var r=0,l=[],a=JSON.parse(Base64.decode(e.split("ssd://")[1])),n="shadowsocks=",o="password="+a.password,p="method="+a.encryption,f="",u="",c=a.port?":"+a.port:"";for(var _ in a.plugin_options&&(f=null!=a.plugin_options.split(";")[0]?", "+a.plugin_options.split(";")[0]:"",u=null!=a.plugin_options.split(";")[1]?", "+a.plugin_options.split(";")[1]:""),pudp=1==t?"udp-relay=true":"udp-relay=false",ptfo=1==s?"fast-open=true":"fast-open=false",a.servers)if(ip=a.servers[_].server,a.servers[_].plugin_options&&(f=null!=a.servers[_].plugin_options.split(";")[0]?", "+a.servers[_].plugin_options.split(";")[0]:"",u=null!=a.servers[_].plugin_options.split(";")[1]?", "+a.servers[_].plugin_options.split(";")[1]:""),a.servers[_].encryption&&(p="method="+a.servers[_].encryption),a.servers[_].password&&(o="password="+a.servers[_].password),ip.indexOf(".")>0){c=a.servers[_].port?":"+a.servers[_].port:c,tag="tag="+a.servers[_].remarks,l[r]=n+ip+c+", "+o+", "+p+f+u+", "+pudp+", "+ptfo+", "+tag;var r=r+1}return l}function QXFix(e){var t=e.replace(/\s*tag\s*\=/g,"tag=").replace("chacha20-poly","chacha20-ietf-poly");try{var s=t.split(",tag=")[0],r="tag="+t.split(",tag=")[1].split(",")[0].trim(),l=t.split(r+",");for(i in cntis=(t=l.length<=1?t:String(s+","+l[1].split("\r")[0]+","+r)).split(",").filter(Boolean).map(e=>e.trim()),tagfix="",cntii="",cntis)-1==cntis[i].indexOf("=")&&""!=cntis[i].trim()?tagfix+=","+cntis[i]:0!=cntis[i].indexOf("tag=")?cntii+=cntis[i]+", ":cntii;return cntii=cntii+r+tagfix}catch(a){0==Perror&&$notify("âŒ è§£æå‡ºç°é”™è¯¯,å·²å¿½ç•¥è¯¥æ¡ç›®","âš ï¸ è¯·ç‚¹å‡»é€šçŸ¥ï¼Œå‘é€è®¢é˜…é“¾æ¥è¿›è¡Œåé¦ˆ",e+"\n"+a,bug_link)}return""}function isQuanX(e){for(var t=e.split("\n"),s=[],r=0;r<t.length;r++){var l=t[r];if(-1!=l.indexOf("=")&&-1!=l.indexOf("tag")){var a=l.split("=")[0].trim();("http"==a||"shadowsocks"==a||"trojan"==a||"vmess"==a||"socks5"==a||"vless"==a)&&s.push(QXFix(l))}}return s}function isQuanXRewrite(e){cnt=e,cnt0=[];for(var t=["host,","-suffix,","domain,","-keyword,","ip-cidr,","ip-cidr6,","geoip,","user-agent,","ip6-cidr,","force-http","ip-asn"],s=0;s<cnt.length;s++)if(cnt[s]){var r=cnt[s].trim();let l=e=>-1!=r.toLowerCase().indexOf(e);-1!=r.indexOf("pattern")&&-1!=r.indexOf("type")||-1!=r.indexOf("http-r")?r=SGMD2QX(r)[0]?SGMD2QX(r)[0]:"":(-1!=r.indexOf(" 302")||-1!=r.indexOf(" 307")||/\s(_|-)\s(reject|REJECT)/.test(r)||/\sreject$/.test(r)||/\sreject-/.test(r))&&-1==r.indexOf(" url ")&&-1==r.indexOf(" url-and-header ")?r=SGMD2QX(r)[0]?SGMD2QX(r)[0]:"":-1!=r.indexOf(" data=")?r=SGMD2QX("[Map Local]\n"+r)[0]?SGMD2QX("[Map Local]\n"+r)[0]:"":-1!=r.indexOf("URL-REGEX")||-1!=r.indexOf(" header")||-1!=r.replace(/ /g,"").indexOf("hostname=")?r=SGMD2QX(r)[0]?SGMD2QX(r)[0]:"":-1!=r.indexOf(" url ")&&-1==r.indexOf(" simple-response ")&&-1==r.indexOf(" url = ")?r="url"==(r=r.replace("^http","http")).split(" ")[1]?r:"":-1!=r.indexOf(" url-and-header ")||(r=""),""==r||"["==r.trim()[0]||-1!=r.indexOf("RULE-SET")||/cronexp\=|type\=cron/.test(r.replace(/ /g,""))||t.some(l)||/\;$/.test(r)||cnt0.push(r)}return cnt0}function QXSort(e,t){var s=e;return 1==t?s.sort(ToTag):-1==t?s.sort(ToTagR):"x"==t?shuffle(s):"0"==t?s:Sort_KWD(s,t)}function ToTag(e,t){var s;return res=e.split("tag")[1].split("=")[1].trim()>t.split("tag")[1].split("=")[1].trim()?1:-1}function ToTagR(e,t){var s;return res=e.split("tag")[1].split("=")[1].trim()>t.split("tag")[1].split("=")[1].trim()?-1:1}function shuffle(e){for(var t=e,s=t.length-1;s>=0;s--){var r=Math.floor(Math.random()*(s+1)),l=t[r];t[r]=t[s],t[s]=l}return t}function Sort_KWD(e,t){regj=(strlist=-1!=t.indexOf("<")?t.split("<"):t.split(">")).map(e=>RegExp(e,"i")),dir=-1!=t.indexOf("<")?-1:1;for(var s=Array(strlist.length+1),r=0;r<s.length;r++)s[r]=[];for(var r=0;r<e.length;r++){flag=0;for(var l=0;l<strlist.length;l++)if(regj[l].test(e[r])){s[l].push(e[r]),flag=1;break}1!=flag&&s[strlist.length].push(e[r])}return s=-1==PsortX?s.map(e=>e.sort(ToTagR)):s,newarr=MixArr(s=1==PsortX?s.map(e=>e.sort(ToTag)):s,dir)}function MixArr(e,t){var s=[];for(i=0;i<e.length-1;i++)s=1==t?s.concat(e[i]):s.concat(e[e.length-2-i]);return 1==t?s.concat(e[e.length-1].sort(ToTag)):e[e.length-1].sort(ToTagR).concat(s)}function DelReg(e){return delreg=RegExp(delreg,"gmi"),cnt0=(e=e.replace(/tag\s*\=\s*/,"tag=")).split("tag=")[0],cnt1=e.split("tag=")[1].split(",")[0],cnt2=1==e.split("tag=")[1].split(",").length?"":e.split(cnt1)[1],cnt=cnt0+"tag="+cnt1.replace(delreg,"")+cnt2}function Rename(e){var t=e;if(-1==t.indexOf("tag="))return t;hd=t.split("tag=")[0],name=t.split("tag=")[1].split(",")[0].trim(),tail=t.split("tag=")[1].split(",").length<=1?"":t.split("tag=")[1].split(name)[1];for(var s=0;s<Prn.length;s++){if(nname=Prn[s].split("@")[1]?decodeURIComponent(Prn[s].split("@")[1]):Prn[s].split("@")[1],(oname=Prn[s].split("@")[0]?decodeURIComponent(Prn[s].split("@")[0]):Prn[s].split("@")[0])&&nname){var r=escapeRegExp(oname);name=name.replace(RegExp(r,"gm"),nname)}else if(oname&&""==nname){var l=emoji_del(name);name=(1==Pemoji||2==Pemoji)&&Prname?oname+l:oname+name.trim()}else if(nname&&""==oname)name=name.trim()+nname;else if(oname&&-1!=oname.indexOf("â˜ ï¸"))for(j=0,hh=Dot2(oname.slice(0,oname.length-2)).split(".");j<hh.length;j++){var a=escapeRegExp(ToDot(hh[j])),n=RegExp(a,"gm");name=name.replace(n,"")}else""==oname&&""==nname?name=name.replace(/@/g,""):name;nserver=hd+"tag="+name+tail}return nserver}function RenameScript(servers,script){$notify("\uD83E\uDD16 å¯ç”¨è„šæœ¬è¿›è¡Œé‡å‘½å","",script);try{let $=Tools().rename,nodes=Tools().getNodeInfo(servers);eval(script);let newNames=rename(nodes);return servers.map((e,t)=>e.split("tag=")[0]+"tag="+newNames[t])}catch(err){return $notify("âŒ è„šæœ¬é‡å‘½åå‡ºç°é”™è¯¯","",err),servers}}function emoji_del(e){return e.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim()}function get_emoji(e,t){aa=JSON.parse(str1=JSON.stringify({"\uD83C\uDFF3ï¸â€\uD83C\uDF08":["æµé‡","å¥—é¤","å‰©ä½™","é‡ç½®","åˆ°æœŸ","æ—¶é—´","åº”æ€¥","è¿‡æœŸ","Bandwidth","expire","Traffic","traffic"],"\uD83C\uDDF4\uD83C\uDDF2":["é˜¿æ›¼"," OM "],"\uD83C\uDDE6\uD83C\uDDE9":["å®‰é“å°”","å®‰é“çˆ¾","Andorra"],"\uD83C\uDDE6\uD83C\uDDF4":["å®‰å“¥æ‹‰"],"\uD83C\uDDE6\uD83C\uDDEB":["é˜¿å¯Œæ±—"],"\uD83C\uDDE9\uD83C\uDDFF":["é˜¿å°”åŠåˆ©äºš","é˜¿çˆ¾åŠåˆ©äº"],"\uD83C\uDDEB\uD83C\uDDF4":["æ³•ç¾…ç¾¤å³¶","æ³•ç½—ç¾¤å²›"],"\uD83C\uDDE7\uD83C\uDDF2":["ç™¾æ…•å¤§"],"\uD83C\uDDE6\uD83C\uDDFD":["å¥§è˜­ç¾¤å³¶","å¥¥å…°ç¾¤å²›"],"\uD83C\uDDE6\uD83C\uDDFF":["é˜¿å¡æ‹œç–†","Azerbaijan"],"\uD83C\uDDE6\uD83C\uDDF9":["å¥¥åœ°åˆ©","å¥§åœ°åˆ©","Austria","ç»´ä¹Ÿçº³"],"\uD83C\uDDE6\uD83C\uDDFA":["AU","Australia","Sydney","æ¾³å¤§åˆ©äºš","æ¾³æ´²","å¢¨å°”æœ¬","æ‚‰å°¼","åœŸæ¾³","äº¬æ¾³","å»£æ¾³","æ»¬æ¾³","æ²ªæ¾³","å¹¿æ¾³"],"\uD83C\uDDE7\uD83C\uDDEA":["BE","æ¯”åˆ©æ™‚","æ¯”åˆ©æ—¶","Belgium"],"\uD83C\uDDE7\uD83C\uDDEC":["ä¿åŠ åˆ©äºš","ä¿åŠ åˆ©äº","Bulgaria"],"\uD83C\uDDF5\uD83C\uDDF0":["å·´åŸºæ–¯å¦","Pakistan","PAKISTAN"],"\uD83C\uDDE7\uD83C\uDDED":["å·´æ—","Bahrain"],"\uD83C\uDDF5\uD83C\uDDFE":["å·´æ‹‰åœ­","Paraguay"],"\uD83C\uDDE7\uD83C\uDDE7":["å·´å·´å¤šæ–¯"],"\uD83C\uDDEC\uD83C\uDDF6":["èµ¤é“å‡ å†…äºš","èµ¤é“å¹¾å…§äº"],"\uD83C\uDDF9\uD83C\uDDF1":["ä¸œå¸æ±¶","æ±å¸æ±¶"],"\uD83C\uDDF0\uD83C\uDDED":["æŸ¬åŸ”å¯¨","Cambodia"],"\uD83C\uDDFF\uD83C\uDDFC":["æ´¥å·´å¸ƒéŸ¦","æ´¥å·´å¸ƒéŸ‹"],"\uD83C\uDDFA\uD83C\uDDE6":["çƒå…‹è˜­","ä¹Œå…‹å…°","Ukraine"],"\uD83C\uDDFA\uD83C\uDDFF":["ä¹Œå…¹åˆ«å…‹æ–¯å¦","çƒèŒ²åˆ¥å…‹æ–¯å¦","Uzbekistan"],"\uD83C\uDDED\uD83C\uDDF7":["å…‹ç½—åœ°äºš","HR","å…‹ç¾…åœ°äº","Croatia"],"\uD83C\uDDE8\uD83C\uDDE6":["CA","Canada","CANADA","CAN","Waterloo","åŠ æ‹¿å¤§","è’™ç‰¹åˆ©å°”","æ¸©å“¥å","æ¥“è‘‰","æ«å¶","æ»‘é“å¢","å¤šä¼¦å¤š"],"\uD83C\uDDE8\uD83C\uDDED":["ç‘å£«","è‹é»ä¸–","Switzerland","CH "],"\uD83C\uDDF3\uD83C\uDDEC":["å°¼æ—¥åˆ©äºš","NG","å°¼æ—¥åˆ©äº","æ‹‰å„æ–¯","Nigeria"],"\uD83C\uDDE8\uD83C\uDDFF":["Czechia","æ·å…‹"],"\uD83C\uDDF8\uD83C\uDDF0":["æ–¯æ´›ä¼å…‹","SK","Slovakia"],"\uD83C\uDDF8\uD83C\uDDEE":["æ–¯æ´›æ–‡å°¼äºš","æ–¯æ´›æ–‡å°¼äº","Slovenia"],"\uD83C\uDDE6\uD83C\uDDF2":["äºšç¾å°¼äºš","äºç¾å°¼äº","Armenia"],"\uD83C\uDDF7\uD83C\uDDF8":["RS ","RS_","å¡å°”ç»´äºš","å¡çˆ¾ç¶­äº","Seville","Sevilla"],"\uD83C\uDDF2\uD83C\uDDE9":["æ‘©çˆ¾å¤šç“¦"," MD-","æ‘©å°”å¤šç“¦","Moldova"," MD "],"\uD83C\uDDE9\uD83C\uDDEA":["DE ","DE-","DE_","German","GERMAN","å¾·å›½","å¾·åœ‹","æ³•å…°å…‹ç¦","äº¬å¾·","æ»¬å¾·","å»£å¾·","æ²ªå¾·","å¹¿å¾·"],"\uD83C\uDDE9\uD83C\uDDF0":["DK","DNK","ä¸¹éº¦","ä¸¹éº¥","Denmark"],"\uD83C\uDDEA\uD83C\uDDF8":["ES","è¥¿ç­ç‰™","Spain"],"\uD83C\uDDEA\uD83C\uDDFA":["EU","æ¬§ç›Ÿ","æ¬§ç½—å·´","æ¬§æ´²","European"],"\uD83C\uDDEB\uD83C\uDDEE":["Finland","èŠ¬å…°","èŠ¬è˜­","èµ«å°”è¾›åŸº"],"\uD83C\uDDEB\uD83C\uDDF7":["FR","France","æ³•å›½","æ³•åœ‹","å·´é»"],"\uD83C\uDDF7\uD83C\uDDEA":["ç•™å°¼æ±ª","ç•™å°¼æ—º","R\xe9union","Reunion"],"\uD83C\uDDE8\uD83C\uDDFC":["åº“æ‹‰ç´¢","åº«æ‹‰ç´¢","Cura\xe7ao"],"\uD83C\uDDEC\uD83C\uDDE7":["UK","GB ","England","United Kingdom","è‹±å›½","ä¼¦æ•¦","è‹±","Britain"],"\uD83C\uDDF2\uD83C\uDDF4":["MO","Macao","Macau","MAC","æ¾³é—¨","æ¾³é–€","CTM"],"\uD83C\uDDF0\uD83C\uDDFF":["å“ˆè¨å…‹æ–¯å¦","å“ˆè–©å…‹æ–¯å¦","Kazakhstan"],"\uD83C\uDDF1\uD83C\uDDE6":["è€æŒ","è€æŒ","Laos"],"\uD83C\uDDED\uD83C\uDDFA":["åŒˆç‰™åˆ©","Hungary"],"\uD83C\uDDED\uD83C\uDDF3":["æ´ªéƒ½æ‹‰æ–¯"],"\uD83C\uDDF1\uD83C\uDDF9":["ç«‹é™¶å®›","Lithuania"],"\uD83C\uDDF1\uD83C\uDDF0":["æ–¯é‡Œå…°å¡","æ–¯é‡Œè˜­å¡","Sri Lanka"],"\uD83C\uDDE7\uD83C\uDDFE":["BY","ç™½ä¿„ç½—æ–¯","ç™½ä¿„ç¾…æ–¯","White Russia","Republic of Belarus","Belarus"],"\uD83C\uDDF7\uD83C\uDDFA":["RU ","RU-","RU_","RUS","Russia","ä¿„ç½—æ–¯","æ¯›å­","ä¿„å›½","ä¿„ç¾…æ–¯","ä¼¯åŠ›","è«æ–¯ç§‘","åœ£å½¼å¾—å ¡","è¥¿ä¼¯åˆ©äºš","æ–°è¥¿ä¼¯åˆ©äºš","äº¬ä¿„","æ­ä¿„","å»£ä¿„","æ»¬ä¿„","å¹¿ä¿„","æ²ªä¿„"],"\uD83C\uDDF8\uD83C\uDDEC":["SG","Singapore","SINGAPORE","æ–°åŠ å¡","ç‹®åŸ","ç…åŸ","æ²ªæ–°","äº¬æ–°","æ³‰æ–°","ç©—æ–°","æ·±æ–°","æ­æ–°","å¹¿æ–°","å»£æ–°","æ»¬æ–°"],"\uD83C\uDDFA\uD83C\uDDF8":["US","USA","America","United States","ç¾å›½","ç¾","äº¬ç¾","æ³¢ç‰¹å…°","è¾¾æ‹‰æ–¯","ä¿„å‹’å†ˆ","å‡¤å‡°åŸ","è´¹åˆ©è’™","ç¡…è°·","çŸ½è°·","æ‹‰æ–¯ç»´åŠ æ–¯","æ´›æ‰çŸ¶","åœ£ä½•å¡","åœ£è·è¥¿","åœ£å…‹æ‹‰æ‹‰","è¥¿é›…å›¾","èŠåŠ å“¥","æ²ªç¾","å“¥ä¼¦å¸ƒ","çº½çº¦"],"\uD83C\uDDF9\uD83C\uDDFC":["TW","Taiwan","TAIWAN","å°æ¹¾","å°åŒ—","å°ä¸­","æ–°åŒ—","å½°åŒ–","CHT","å°","HINET"],"\uD83C\uDDEE\uD83C\uDDE9":["ID ","IDN ","Indonesia","å°å°¼","å°åº¦å°¼è¥¿äºš","é›…åŠ è¾¾"],"\uD83C\uDDEE\uD83C\uDDEA":["Ireland","IRELAND","IE ","çˆ±å°”å…°","æ„›çˆ¾è˜­","éƒ½æŸæ—"],"\uD83C\uDDEE\uD83C\uDDF1":["Israel","ä»¥è‰²åˆ—"],"\uD83C\uDDEE\uD83C\uDDF3":["India","IND","INDIA","å°åº¦","å­Ÿä¹°","Mumbai","IN "],"\uD83C\uDDEE\uD83C\uDDF8":["IS","ISL","å†°å²›","å†°å³¶","Iceland"],"\uD83C\uDDF0\uD83C\uDDF5":["KP","æœé²œ","North Korea","æœé®®"],"\uD83C\uDDF0\uD83C\uDDF7":["KR","Korea","KOR","éŸ©å›½","é¦–å°”","éŸ©","éŸ“","æ˜¥å·"],"\uD83C\uDDEC\uD83C\uDDED":["åŠ çº³","Ghana","è¿¦ç´"],"\uD83C\uDDF1\uD83C\uDDFA":["å¢æ£®å ¡","ç›§æ£®å ¡","LU ","Luxembourg"],"\uD83C\uDDF1\uD83C\uDDFB":["Latvia","Latvija","æ‹‰è„±ç»´äºš"],"\uD83C\uDDE7\uD83C\uDDE9":["å­ŸåŠ æ‹‰","Bengal"],"\uD83C\uDDF2\uD83C\uDDFDï¸":[" MEX","MX","å¢¨è¥¿å“¥","Mexico","MEXICO"],"\uD83C\uDDF2\uD83C\uDDFE":[" MY","Malaysia","MALAYSIA","é©¬æ¥è¥¿äºš","é©¬æ¥","é¦¬ä¾†","å¤§é©¬","å¤§é¦¬","é¦¬ä¾†è¥¿äº","å‰éš†å¡"],"\uD83C\uDDF2\uD83C\uDDF2":["ç¼…ç”¸","ç·¬ç”¸"],"\uD83C\uDDF3\uD83C\uDDEE":["å°¼åŠ æ‹‰ç“œ"],"\uD83C\uDDF3\uD83C\uDDF1":["NL","Netherlands","è·å…°","è·è˜­","å°¼å¾·è˜­","é˜¿å§†æ–¯ç‰¹ä¸¹"],"\uD83C\uDDF5\uD83C\uDDED":["PH","Philippines","è²å¾‹å®¾","è²å¾‹è³“"],"\uD83C\uDDF7\uD83C\uDDF4":["RO ","ç½—é©¬å°¼äºš","Rumania","ç¾…é¦¬å°¼äº"],"\uD83C\uDDF8\uD83C\uDDE6":["æ²™ç‰¹","åˆ©é›…å¾—","Saudi Arabia","Saudi"],"\uD83C\uDDF8\uD83C\uDDEA":["SE","Sweden","ç‘å…¸"],"\uD83C\uDDF9\uD83C\uDDED":["TH","Thailand","æ³°å›½","æ³°åœ‹","æ›¼è°·"],"\uD83C\uDDF9\uD83C\uDDF7":["TR ","TR-","TR_","TUR","Turkey","åœŸè€³å…¶","ä¼Šæ–¯å¦å¸ƒå°”"],"\uD83C\uDDFB\uD83C\uDDF3":["VN","è¶Šå—","èƒ¡å¿—æ˜å¸‚","Vietnam"],"\uD83C\uDDEE\uD83C\uDDF9":["Italy"," IT ","Nachash","æ„å¤§åˆ©","ç±³å…°","ç¾©å¤§åˆ©"],"\uD83C\uDDFF\uD83C\uDDE6":["South Africa","å—é","Johannesburg"],"\uD83C\uDDE6\uD83C\uDDEA":["United Arab Emirates","é˜¿è”é…‹","AE ","è¿ªæ‹œ","é˜¿è¯é…‹","Dubai"],"\uD83C\uDDE7\uD83C\uDDF7":["BR","Brazil","å·´è¥¿","åœ£ä¿ç½—"],"\uD83C\uDDEF\uD83C\uDDF5":["JP","Japan","JAPAN","æ—¥æœ¬","ä¸œäº¬","å¤§é˜ª","åŸ¼ç‰","äº¬æ—¥","è‹æ—¥","æ²ªæ—¥","ä¸Šæ—¥","ç©—æ—¥","å·æ—¥","ä¸­æ—¥","æ³‰æ—¥","æ­æ—¥","æ·±æ—¥","è¾½æ—¥","å¹¿æ—¥","Tokyo"],"\uD83C\uDDE6\uD83C\uDDF7":["AR ","Argentina","é˜¿æ ¹å»·","AR-"],"\uD83C\uDDF3\uD83C\uDDF4":["Norway","æŒªå¨","NO"],"\uD83C\uDDF5\uD83C\uDDF1":[" PL","POL","æ³¢å…°","æ³¢è˜­","Poland"],"\uD83C\uDDE8\uD83C\uDDF1":["æ™ºåˆ©","Chile","CHILE"],"\uD83C\uDDF3\uD83C\uDDFF":["æ–°è¥¿è˜­","æ–°è¥¿å…°","New Zealand"],"\uD83C\uDDEC\uD83C\uDDF7":["å¸Œè…Š","å¸Œè‡˜","Greece"],"\uD83C\uDDEA\uD83C\uDDEC":["åŸƒåŠ","Egypt"],"\uD83C\uDDEE\uD83C\uDDF2":["é©¬æ©å²›","é¦¬æ©å³¶","Isle of Man","Mannin"],"\uD83C\uDDF5\uD83C\uDDF9":["è‘¡è„ç‰™","Portugal"],"\uD83C\uDDF2\uD83C\uDDF3":["è’™å¤","Mongolia"],"\uD83C\uDDF5\uD83C\uDDEA":["ç§˜é²","ç¥•é­¯","Peru"],"\uD83C\uDDE8\uD83C\uDDF4":["å“¥ä¼¦æ¯”äºš","å“¥å€«æ¯”äº","Colombia"],"\uD83C\uDDEA\uD83C\uDDEA":["çˆ±æ²™å°¼äºš","æ„›æ²™å°¼äº","Estonia"],"\uD83C\uDDF1\uD83C\uDDFE":["åˆ©æ¯”äºš","åˆ©æ¯”äº","Libya"],"\uD83C\uDDF2\uD83C\uDDF0":["é©¬å…¶é¡¿","é¦¬å…¶é “","Macedonia"],"\uD83C\uDDF2\uD83C\uDDF9":["é©¬è€³ä»–","é¦¬å…¶ä»–","Malta"],"\uD83C\uDDFB\uD83C\uDDEA":["å§”å†…ç‘æ‹‰","Venezuela"],"\uD83C\uDDE7\uD83C\uDDE6":["æ³¢é»‘å…±å’Œå›½","æ³¢é»‘","Bosnia and Herzegovina"],"\uD83C\uDDEC\uD83C\uDDEA":["æ ¼é­¯å‰äº","æ ¼é²å‰äºš","Georgia"],"\uD83C\uDDE6\uD83C\uDDF1":["é˜¿çˆ¾å·´å°¼äº","é˜¿å°”å·´å°¼äºš","Albania"],"\uD83C\uDDE8\uD83C\uDDFE":["CY","å¡æµ¦è·¯æ–¯","Cyprus"],"\uD83C\uDDE8\uD83C\uDDF7":["å“¥æ–¯è¾¾é»åŠ ","å“¥æ–¯é”å°¼åŠ ","Costa Rica"],"\uD83C\uDDF9\uD83C\uDDF3":["çªå°¼æ–¯","Tunisia"],"\uD83C\uDDFB\uD83C\uDDE6":["æ¢µè’‚å†ˆ","æ¢µè’‚å²¡"],"\uD83C\uDDF7\uD83C\uDDFC":["å¢æ—ºè¾¾","ç›§æ—ºé”"],"\uD83C\uDDF5\uD83C\uDDE6":["å·´æ‹¿é©¬","å·´æ‹¿é¦¬","Panama"],"\uD83C\uDDEE\uD83C\uDDF7":["ä¼Šæœ—","Iran"],"\uD83C\uDDEF\uD83C\uDDF4":["çº¦æ—¦","ç´„æ—¦","Jordan"],"\uD83C\uDDFA\uD83C\uDDFE":["ä¹Œæ‹‰åœ­","çƒæ‹‰åœ­","Uruguay"],"\uD83C\uDDF0\uD83C\uDDEA":["è‚¯å°¼äºš","è‚¯å°¼äº","Kenya"],"\uD83C\uDDF0\uD83C\uDDEC":["å‰å°”å‰æ–¯å¦","å‰å°”å‰æ–¯æ–¯å¦","Kyrghyzstan"],"\uD83C\uDDF3\uD83C\uDDF5":["å°¼æ³Šå°”","å°¼æ³Šçˆ¾","Nepal"],"\uD83C\uDDFD\uD83C\uDDF0":["ç§‘ç´¢æ²ƒ","Kosovo"],"\uD83C\uDDF2\uD83C\uDDE6":["æ‘©æ´›å“¥","Morocco"],"\uD83C\uDDEA\uD83C\uDDE8":["å„ç“œå¤šå°”","å„ç“œå¤šçˆ¾","EC","Ecuador"],"\uD83C\uDDF2\uD83C\uDDFA":["æ¯›é‡Œæ±‚æ–¯","Mauritius"],"\uD83C\uDDF5\uD83C\uDDF7":["æ³¢å¤šé»å„","PR ","PR-","Puerto Rico"],"\uD83C\uDDEC\uD83C\uDDF9":["å±åœ°é©¬æ‹‰","å±åœ°é¦¬æ‹‰"," GT "],"\uD83C\uDDED\uD83C\uDDF0":["HK","Hongkong","Hong Kong","HongKong","HONG KONG","é¦™æ¸¯","æ·±æ¸¯","æ²ªæ¸¯","å‘¼æ¸¯","HKT","HKBN","HGC","WTT","CMI","ç©—æ¸¯","äº¬æ¸¯","æ¸¯"],"\uD83C\uDDE8\uD83C\uDDF3":["CN","China","å›å›½","ä¸­å›½","ä¸­åœ‹","æ±Ÿè‹","åŒ—äº¬","ä¸Šæµ·","å¹¿å·","æ·±åœ³","æ­å·","å¾å·","é’å²›","å®æ³¢","é•‡æ±Ÿ","back"],"\uD83C\uDDE8\uD83C\uDDFA":["å¤å·´"],"\uD83C\uDDF8\uD83C\uDDF2":["åœ£é©¬åŠ›è¯º","è–é¦¬åˆ©è«¾"],"\uD83C\uDDF0\uD83C\uDDFE":["å¼€æ›¼ç¾¤å²›","é–‹æ›¼ç¾¤å³¶"],"\uD83C\uDDEB\uD83C\uDDEF":["æ–æµ","æ–æ¿Ÿ"],"\uD83C\uDDEC\uD83C\uDDF1":["æ ¼é™µå…°","æ ¼é™µè˜­"],"\uD83C\uDDEC\uD83C\uDDEE":["ç›´å¸ƒç½—é™€","ç›´å¸ƒç¾…é™€"],"\uD83C\uDDF2\uD83C\uDDEA":["é»‘å±±"],"\uD83C\uDDF1\uD83C\uDDEE":["åˆ—æ”¯æ•¦å£«ç™»"],"\uD83C\uDDEC\uD83C\uDDFA":["å…³å²›","é—œå³¶"],"\uD83C\uDDE6\uD83C\uDDF6":["å—æ","å—æ¥µ"],"\uD83C\uDDE7\uD83C\uDDF9":["ä¸ä¸¹"],"\uD83C\uDDF2\uD83C\uDDFB":["é©¬å°”ä»£å¤«","é¦¬çˆ¾ä»£å¤«"],"\uD83C\uDDEE\uD83C\uDDF6":["ä¼Šæ‹‰å…‹"],"\uD83C\uDDF8\uD83C\uDDE8":["å¡èˆŒå°”","å¡èˆŒçˆ¾"],"\uD83C\uDDF6\uD83C\uDDE6":["å¡å¡”å°”","å¡å¡”çˆ¾"," QA "],"\uD83C\uDDF8\uD83C\uDDFE":["å™åˆ©äºš","æ•˜åˆ©äº"," SY "],"\uD83C\uDDF1\uD83C\uDDE7":["é»å·´å«©","LB","Lebanon"],"\uD83C\uDDE7\uD83C\uDDF3":["æ–‡è±","æ±¶èŠ","BRN","Negara Brunei Darussalam"],"\uD83C\uDDE8\uD83C\uDDFB":["ä½›å¾—è§’"],"\uD83C\uDDF8\uD83C\uDDF7":["è‹é‡Œå—","è˜‡é‡Œå—"],"\uD83C\uDDF2\uD83C\uDDE8":["æ‘©çº³å“¥","æ‘©ç´å“¥"],"\uD83C\uDDEF\uD83C\uDDF2":["ç‰™ä¹°åŠ ","ç‰™è²·åŠ  "],"\uD83C\uDF0F":["äºšæ´²","Asia"],"\uD83C\uDDF9\uD83C\uDDEC":["å¤šå“¥"],"\uD83C\uDDF5\uD83C\uDDF8":["å·´å‹’æ–¯å¦"],"\uD83C\uDDEC\uD83C\uDDEB":["æ³•å±¬åœ­äºé‚£","æ³•å±åœ­äºšé‚£"],"\uD83C\uDDF9\uD83C\uDDF9":["ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥","ç‰¹ç«‹å°¼é”å’Œå¤šå·´å“¥"]})),bb=JSON.parse(str1.replace(/ğŸ‡¹ğŸ‡¼/g," \uD83C\uDDE8\uD83C\uDDF3"));var s=1==e?aa:bb,r=0;for(var l in s)for(i in dd=s[l])if(-1!=t.indexOf(dd[i]))return r=1,[nname=l+" "+t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim(),l];if(0==r)return["\uD83C\uDFF4â€â˜ ï¸ "+t.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g,"").trim(),"\uD83C\uDFF4â€â˜ ï¸"]}function emoji_handle(e,t){for(var s=[],r=e,l=0;l<r.length;l++)if(-1!=r[l].indexOf("tag=")){var a=r[l].split("tag=")[1].trim(),n=r[l].split("tag=")[0],o=a;if(1==t)var o=get_emoji(1,o)[0];else if(2==t)var o=get_emoji(2,o)[0];else -1==t&&(o=emoji_del(a));var p=n+"tag="+o.replace("  "," ").trim();s.push(p)}return s}function Surge2QX(e){for(var t=e.split("\n").map(isSurge).filter(Boolean),s=[],r="",l=0;l<t.length;l++){var a=t[l];if(-1!=a.split("=")[1].split(",")[0].indexOf("trojan")?r=Strojan2QX(a):-1!=a.split("=")[1].split(",")[0].indexOf("http")?r=Shttp2QX(a):-1!=a.split("=")[1].split(",")[0].indexOf("vmess")?r=SVmess2QX(a):-1!=a.split("=")[1].split(",")[0].indexOf("ss")?r=SSS2QX(a):-1!=a.split("=")[1].split(",")[0].indexOf("socks5")?r=SS52QX(a):-1!=a.split("=")[1].split(",")[0].indexOf("custom")&&(r=SCT2QX(a)),r=0!=Pudp0?XUDP(r,Pudp0):r,r=0!=Ptfo0?XTFO(r,Ptfo0):r,-1!=a.indexOf("test-url")){var n=", server_check_url"+a.split("test-url")[1].split(",")[0];r=r.replace(/\,(\s)*tag/,n+", tag")}s.push(r)}return s}function SCT2QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l="method="+t.split(",")[3].trim(),a="password="+t.split(",")[4].trim();pobfs=-1!=t.indexOf("obfs")?"obfs="+t.replace(/obfs-host/,"").split("obfs")[1].split(",")[0].split("=")[1]:"";var n=-1!=t.indexOf("obfs-host")?"obfs-host"+t.split("obfs-host")[1].split(",")[0].trim():"";""!=n&&(pobfs=pobfs+", "+n);var o="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false",p="true"==paraCheck(t,"udp-relay")?"udp-relay=true":"udp-relay=false";return""!=pobfs?"shadowsocks= "+[r,l,a,pobfs,o,p,s].join(", "):"shadowsocks= "+[r,l,a,o,p,s].join(", ")}function SSS2QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l="method="+t.split("encrypt-method")[1].split(",")[0].split("=")[1],a="password="+t.split("password")[1].split(",")[0].split("=")[1];pobfs=-1!=t.indexOf("obfs")?"obfs="+t.replace(/obfs-host/,"").split("obfs")[1].split(",")[0].split("=")[1]:"";var n=-1!=t.indexOf("obfs-host")?"obfs-host"+t.split("obfs-host")[1].split(",")[0].trim():"";""!=n&&(pobfs=pobfs+", "+n);var o="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false",p="true"==paraCheck(t,"udp-relay")?"udp-relay=true":"udp-relay=false";return""!=pobfs?"shadowsocks= "+[r,l,a,pobfs,o,p,s].join(", "):"shadowsocks= "+[r,l,a,o,p,s].join(", ")}function SVmess2QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l=-1!=t.indexOf("username")?"password="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",a="method=aes-128-gcm",n="true"==paraCheck(t,"tls13")?"tls13=true":"tls13=false",o=-1!=t.replace(/ /g,"").indexOf("skip-cert-verify=false")?"tls-verification=true":"tls-verification=false";pvefify=1==Pcert0?"tls-verification=true":o,"true"==paraCheck(t.replace(/tls13/,""),"tls")&&"true"==paraCheck(t.replace(/ws-header/,""),"ws")?pobfs="obfs=wss, "+n+", "+o:"true"==paraCheck(t.replace(/ws-header/,""),"ws")?pobfs="obfs=ws":"false"!=paraCheck(t.replace(/tls13/,""),"tls")?pobfs="obfs=over-tls, "+n+", "+o:"false"==paraCheck(t.replace(/ws-header/,""),"ws")&&(pobfs="");var p="false"!=paraCheck(t,"ws-path")?"obfs-uri="+t.split("ws-path")[1].split(",")[0].split("=")[1].trim():"obfs-uri=/",f=-1!=t.indexOf("ws-headers")?"obfs-host="+t.split("ws-headers")[1].split(",")[0].split("=")[1].split(":")[1].trim():"";-1!=pobfs.indexOf("ws")&&(pobfs=""!=f?pobfs+", "+p+", "+f:pobfs+", "+p);var u="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false";return""!=pobfs?"vmess= "+[r,l,a,pobfs,u,s].join(", "):"vmess= "+[r,l,a,u,s].join(", ")}function isSurge(e){if(-1!=e.indexOf("=")&&("http"==(cnt=e.split("=")[1].split(",")[0].trim())||"ss"==cnt||"trojan"==cnt||"vmess"==cnt||"custom"==cnt||"https"==cnt||"socks5"==cnt||"socks5-tls"==cnt))return e}function paraCheck(e,t){return -1==(e=e.replace(/ /g,"")).indexOf(t+"=")?"false":e.split(t+"=")[1].split(",")[0].trim()}function Strojan2QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l="password="+t.split("password")[1].split(",")[0].split("=")[1].trim(),a="over-tls=true",n="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false",o=-1!=t.replace(/ /g,"").indexOf("skip-cert-verify=false")?"tls-verification=true":"tls-verification=false",p=-1!=t.indexOf("sni")?"tls-host="+t.split("sni")[1].split(",")[0].split("=")[1]:"";pvefify=1==Pcert0?"tls-verification=true":o;var f="true"==paraCheck(t,"tls13")?"tls13=true":"tls13=false";return"trojan= "+[r,l,a,n,f,p,o,s].filter(Boolean).join(", ")}function Shttp2QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l=-1!=t.indexOf("username")?"username="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",a=-1!=t.indexOf("password")?"password="+t.split("password")[1].split(",")[0].split("=")[1].trim():"",n="https"==t.split("=")[1].split(",")[0].trim()?"over-tls=true":"over-tls=false",o="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false";if("over-tls=true"==n){var p,f=-1!=t.replace(/ /g,"").indexOf("skip-cert-verify=false")?"tls-verification=true":"tls-verification=false";pvefify=1==Pcert0?"tls-verification=true":f,n=n+", "+f+", "+("true"==paraCheck(t,"tls13")?"tls13=true":"tls13=false")}return""!=l?"http= "+[r,l,a,n,o,s].join(", "):"http= "+[r,n,o,s].join(", ")}function SS52QX(e){var t=e,s="tag="+t.split("=")[0].trim(),r=t.split(",")[1].trim()+":"+t.split(",")[2].trim(),l=-1!=t.indexOf("username")?"username="+t.split("username")[1].split(",")[0].split("=")[1].trim():"",a=-1!=t.indexOf("password")?"password="+t.split("password")[1].split(",")[0].split("=")[1].trim():"",n="socks5-tls"==t.split("=")[1].split(",")[0].trim()?"over-tls=true":"over-tls=false",o="true"==paraCheck(t,"tfo")?"fast-open=true":"fast-open=false";if("over-tls=true"==n){var p,f=-1!=t.replace(/ /g,"").indexOf("skip-cert-verify=false")?"tls-verification=true":"tls-verification=false";pvefify=1==Pcert0?"tls-verification=true":f,n=n+", "+f+", "+("true"==paraCheck(t,"tls13")?"tls13=true":"tls13=false")}return""!=l?"socks5= "+[r,l,a,n,o,s].join(", "):"socks5= "+[r,n,o,s].join(", ")}function Loon2QX(e){var t=e.split("=")[1].split(",")[0].trim(),s="";return"Shadowsocks"==t?s=LoonSS2QX(e):"ShadowsocksR"==t?s=LoonSSR2QX(e):"VLESS"==t&&(s=LoonVL2QX(e)),s}function LoonSS2QX(e){var t="shadowsocks=",s=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),r="method="+e.split(",")[3].trim(),l="password="+e.split(",")[4].trim().split('"')[1],a=7==e.split(",").length?", "+["obfs="+e.split(",")[5].trim(),"obfs-host="+e.split(",")[6].trim()].join(","):"",n=", tag="+e.split("=")[0].trim();return t+[s,r,l].join(", ")+a+n}function LoonSSR2QX(e){var t="shadowsocks=",s=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),r="method="+e.split(",")[3].trim(),l="password="+e.split(",")[4].trim().split('"')[1],a="ssr-protocol="+e.split(",")[5].trim(),n="ssr-protocol-param="+e.split(",")[6].replace(/\{|\}/g,"").trim(),o="obfs="+e.split(",")[7].trim(),p="obfs-host="+e.split(",")[8].replace(/\{|\}/g,"").trim(),f=", tag="+e.split("=")[0].trim();return t+[s,r,l,a,n,o,p].join(", ")+f}function LoonVL2QX(e){var t=", tag="+e.split("=")[0].trim();e=e.replace(" ","");var s="vless=",r=[e.split(",")[1].trim(),e.split(",")[2].trim()].join(":"),l="method=none",a="password="+e.split(",")[3].trim().split('"')[1];return -1!=e.indexOf("transport=tcp")?obfs="-1"==e.indexOf("over-tls=true")?"":"obfs=over-tls":-1!=e.indexOf("transport=http")?obfs="obfs=http":-1!=e.indexOf("transport=ws")&&(obfs="-1"==e.indexOf("over-tls=true")?"obfs=ws":"obfs=wss"),vpath=-1==e.indexOf("path=")?"":"obfs-uri="+e.split("path=")[1].split(",")[0],-1!=e.indexOf("host=")?obfshost="obfs-host="+e.split("host=")[1].split(",")[0]:-1!=e.indexOf("tls-name=")&&(obfshost="obfs-host="+e.split("tls-name=")[1].split(",")[0]),s=s+[r,l,a,obfs,obfshost,vpath].join(", ")+t}function YAMLFix(e){return -1!=(e=e.replace(/\[/g,"yaml@bug1").replace(/\\r/g,"").replace(/\*/g,"yaml@bug2")).indexOf("{")&&/\{\s*\"*(name|type|server)/.test(e)&&(e=e.replace(/(^|\n)- /g,"$1  - ").replace(/    - /g,"  - ").replace(/:(?!\s)/g,": ").replace(/\,\"/g,', "').replace(/: {/g,": {,   ").replace(/, (Host|host|path|mux)/g,",   $1"),console.log("1st:\n"+e),e=(e=e.replace(/{\s*name: (.*?), (.*?):/g,'{name: "$1", $2:')).replace(/{\s*|\s*}/g,"").replace(/,/g,"\n   ")),e=e.replace(/\n\s*\-\s*\n.*name/g,"\n  - name").replace(/\$|\`/g,"").split("proxy-providers:")[0].split("proxy-groups:")[0].replace(/\"(name|type|server|port|cipher|password|uuid|alterId|udp)(\"*)/g,"$1"),1==Pdbg&&$notify("part-fix0:","","part-fix0:\nproxies:\n"+e.split("proxies:")[1]),e=e.replace(/\n\s{2}([a-zA-Z]+.*\:)/g,"\n    $1").replace(/\n(\-.*)/g,"\n  $1"),1==Pdbg&&$notify("part-fix1:","","part-fix1:\nproxies:\n"+e.split("proxies:")[1]),e=-1==(e=-1!=(e=(items=(e=e.replace(/name\:(.*?)\:(.*?)\n/gmi,"name:$1å†’å·$2\n").replace(/\s{6}Host\:/g,"      Host:")).split("\n").map(yamlcheck)).join("\n")).indexOf("proxies:")&&/\n\s{4}server/.test(e)?e.replace(/\n\s{4}(headers|path)/g,"\n      $1").replace(/\n\s{6}Host/g,"\n        Host").replace(/\t/g,""):e).indexOf("proxies:")?"proxies:\n"+e:"proxies:"+e.split("proxies:")[1],console.log("after-fix\n"+e),1==Pdbg&&$notify("After-Fix","this is","After-fix:\n"+e),e}function yamlcheck(e){if(-1!=e.indexOf("name"))for(var t=0;t<10;t++)e=e.replace(RegExp(patn[0][t],"gmi"),patn[4][t]);if(/(:|-)/.test(e))return e}function Clash2QX(e){let t=new YAML;1==Pdbg&&$notify(" Before YAML Parse","content",e);for(var s=JSON.stringify(t.parse(YAMLFix(e))).replace(/yaml@bugğŸ™/g,"[").replace(/å†’å·/gmi,":").replace(/yaml@bugğŸš/g,"*"),r=0;r<10;r++)s=s.replace(RegExp(patn[4][r],"gmi"),patn[0][r]);var l=JSON.parse(s).proxies;1==Pdbg&&$notify("After YAML Parse","content",JSON.stringify(l));var a=l.length,n=[],o="";for(r=0;r<a;r++)try{typecc=(o=l[r]).type,"ss"==typecc?o=CSS2QX(o):"ssr"==typecc?o=CSSR2QX(o):"vmess"==typecc?o=CV2QX(o):"trojan"==typecc?o=CT2QX(o):"http"==typecc?o=CH2QX(o):"socks5"==typecc&&(o=CS52QX(o)),o=0!=Pudp0?XUDP(o,Pudp0):o,o=0!=Ptfo0?XTFO(o,Ptfo0):o,n.push(o)}catch(p){$notify(`âš ï¸è¯¥èŠ‚ç‚¹è§£æé”™è¯¯, æš‚æ—¶å·²å¿½ç•¥å¤„ç†`,`å¯ç‚¹å‡»é€šçŸ¥å¹¶å‘é€é“¾æ¥åé¦ˆè‡³ bot`,JSON.stringify(o),bug_link),$notify(`âš ï¸é”™è¯¯å†…å®¹å¦‚ä¸‹`,`å¯å¤åˆ¶é”™è¯¯å†…å®¹åˆ°åé¦ˆ bot`,JSON.stringify(o)+"\n\n"+p)}return n.join("\n")}function CSS2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi,""),ipt=e.server+":"+e.port,pwd="password="+e.password,mtd="method="+e.cipher,udp=e.udp?"udp-relay=true":"udp-relay=false",uot=e["udp-over-tcp"]?"udp-over-tcp=true":"udp-over-tcp=false",tfo=e.tfo?"fast-open=true":"fast-open=false",obfs=e["plugin-opts"]?"obfs="+e["plugin-opts"].mode:"",ohost=e["plugin-opts"]?"obfs-host="+e["plugin-opts"].host:"",ouri="",cert="",-1!=obfs.indexOf("websocket")&&(obfs=e["plugin-opts"].tls?"obfs=wss":"obfs=ws",ohost=e["plugin-opts"].host?"obfs-host="+e["plugin-opts"].host:"",ouri=e["plugin-opts"].path?"obfs-uri="+e["plugin-opts"].path:"","obfs=wss"==obfs&&(cert=1==Pcert0?"":"tls-verification =false")),node="shadowsocks="+[ipt,pwd,mtd,udp,uot,tfo,obfs,ohost,ouri,cert,tag].filter(Boolean).join(", ")}function CSSR2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi,""),ipt=e.server+":"+e.port,pwd="password="+e.password,mtd="method="+e.cipher,udp=e.udp?"udp-relay=true":"udp-relay=false",tfo=e.tfo?"fast-open=true":"fast-open=false",prot="ssr-protocol="+e.protocol,ohost="",ppara="",e.protocolparam&&(e["protocol-param"]=e.protocolparam),"string"==typeof e["protocol-param"]?ppara="ssr-protocol-param="+e["protocol-param"]:"object"==typeof e["protocol-param"]&&(console.log(typeof e["protocol-param"]),ppara="ssr-protocol-param="+JSON.stringify(e["protocol-param"]).replace(/{|}|\s|"/g,"")),obfs="obfs="+e.obfs,e["obfs-param"]?ohost="obfs-host="+e["obfs-param"]:e.obfsparam&&(ohost="obfs-host="+e.obfsparam),node="shadowsocks="+[ipt,pwd,mtd,udp,tfo,prot,ppara,obfs,ohost,tag].filter(Boolean).join(", ")}function CV2QX(e){tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,pwd="password="+e.uuid,mtd="method=aes-128-gcm",udp=(e.udp,"udp-relay=false"),tfo=e.tfo?"fast-open=true":"fast-open=false",obfs="","ws"==e.network&&e.tls?obfs="obfs=wss":"ws"==e.network?obfs="obfs=ws":"http"==e.network?obfs="obfs=http":e.tls&&(obfs="obfs=over-tls"),console.log(obfs);let t=getValue(()=>e["ws-opts"].headers.Host);return ohost=e["ws-headers"]?"obfs-host="+e["ws-headers"].Host:"",ohost=t?"obfs-host="+t:ohost,ohost=e.servername?"obfs-host="+e.servername:ohost,console.log(ohost),ouri=e["ws-path"]?"obfs-uri="+e["ws-path"]:"",ouri=e["ws-opts"]?"obfs-uri="+e["ws-opts"].path:ouri,cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",caead=e.alterId&&0!=e.alterId?"aead=false":"",console.log(caead),1==Pcert0&&e.tls?cert="tls-verification=true":1!=Pcert0&&e.tls&&(cert="tls-verification=false"),node="vmess="+[ipt,pwd,mtd,udp,tfo,obfs,ohost,ouri,cert,caead,tag].filter(Boolean).join(", ")}function CT2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,pwd="password="+e.password,otls="over-tls=true",opath="",ohost="",cert=e["skip-cert-verify"]?"tls-verification=false":"tls-verification=true",cert=1==Pcert0?"tls-verification=true":"tls-verification=false",tls13=1==PTls13?"tls13=true":"tls13=false",udp=(e.udp,"udp-relay=false"),tfo=e.tfo?"fast-open=true":"fast-open=false","ws"==e.network&&(otls="obfs=wss",e["ws-opts"]&&(opath=e["ws-opts"].path?"obfs-uri="+e["ws-opts"].path:"",ohost=e["ws-opts"].headers?"obfs-host="+e["ws-opts"].headers.Host:"")),node="trojan="+[ipt,pwd,otls,opath,ohost,cert,tls13,udp,tfo,tag].filter(Boolean).join(", ")}function CH2QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,uname=e.username?"username="+e.username:"",pwd=e.password&&"string"==typeof e.password?"password="+e.password:"",tls=e.tls?"over-tls=true":"",cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",1==Pcert0&&e.tls?cert="tls-verification=true":1!=Pcert0&&e.tls&&(cert="tls-verification=false"),node="http="+[ipt,uname,pwd,tls,cert,tag].filter(Boolean).join(", ")}function CS52QX(e){return tag="tag="+e.name.replace(/\\U.+?\s{1}/gi," "),ipt=e.server+":"+e.port,uname=e.username?"username="+e.username:"",pwd=e.password&&"string"==typeof e.password?"password="+e.password:"",tls=e.tls?"over-tls=true":"",cert=e["skip-cert-verify"]&&e.tls?"tls-verification=false":"",1==Pcert0&&e.tls?cert="tls-verification=true":1!=Pcert0&&e.tls&&(cert="tls-verification=false"),node="socks5="+[ipt,uname,pwd,tls,cert,tag].filter(Boolean).join(", ")}function XUDP(e,t){var s=1==t&&/^(shadowsocks|trojan|vmess)/.test(e.trim())?"udp-relay=true, ":"udp-relay=false, ";if(-1!=e.indexOf("udp-relay"))var r=e.replace(RegExp("udp-relay.*?,","gmi"),s);else var r=e.replace(RegExp("tag.*?=","gmi"),s+"tag=");return r}function XTFO(e,t){var s=1==t?"fast-open=true, ":"fast-open=false, ";if(-1!=e.indexOf("fast-open"))var r=e.replace(RegExp("fast-open.*?,","gmi"),s);else var r=e.replace(RegExp("tag.*?=","gmi"),s+"tag=");return r}function UOT(e){return cnts=e.replace(/\s*/g,""),/^shadowsocks=/.test(cnts)&&(e=-1!=cnts.indexOf("udp-over-tcp")?e.replace(/udp-over-tcp\s*\=\s*false/g,"udp-over-tcp=true"):e+", udp-over-tcp=true"),e}function Base64Code(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=function(e){for(var t={},s=0,r=e.length;s<r;s++)t[e.charAt(s)]=s;return t}(e),s=String.fromCharCode,r=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?s(192|t>>>6)+s(128|63&t):s(224|t>>>12&15)+s(128|t>>>6&63)+s(128|63&t)}var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return s(240|t>>>18&7)+s(128|t>>>12&63)+s(128|t>>>6&63)+s(128|63&t)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,a=function(e){return e.replace(l,r)},n=function(t){var s=[0,2,1][t.length%3],r=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[e.charAt(r>>>18),e.charAt(r>>>12&63),s>=2?"=":e.charAt(r>>>6&63),s>=1?"=":e.charAt(63&r)].join("")},o=function(e){return e.replace(/[\s\S]{1,3}/g,n)};this.encode=function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)?e.toString("base64"):o(a(String(e)))};var p=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,f=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return s((t>>>10)+55296)+s((1023&t)+56320);case 3:return s((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return s((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},u=function(e){return e.replace(p,f)},c=function(e){var r=e.length,l=r%4,a=(r>0?t[e.charAt(0)]<<18:0)|(r>1?t[e.charAt(1)]<<12:0)|(r>2?t[e.charAt(2)]<<6:0)|(r>3?t[e.charAt(3)]:0),n=[s(a>>>16),s(a>>>8&255),s(255&a)];return n.length-=[0,0,2,1][l],n.join("")},_=function(e){return e.replace(/\S{1,4}/g,c)},d=function(e){return u(_(e))};this.decode=function(e){return d(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")).replace(/&gt;/g,">").replace(/&lt;/g,"<")}}function YAML(){var e=[],t=[],s=0,r={regLevel:RegExp("^([\\s\\-]+)"),invalidLine:RegExp("^\\-\\-\\-|^\\.\\.\\.|^\\s*#.*|^\\s*$"),dashesString:RegExp('^\\s*\\"([^\\"]*)\\"\\s*$'),quotesString:RegExp("^\\s*\\'([^\\']*)\\'\\s*$"),float:RegExp("^[+-]?[0-9]+\\.[0-9]+(e[+-]?[0-9]+(\\.[0-9]+)?)?$"),integer:RegExp("^[+-]?[0-9]+$"),array:RegExp("\\[\\s*(.*)\\s*\\]"),map:RegExp("\\{\\s*(.*)\\s*\\}"),key_value:RegExp("([a-z0-9_-][ a-z0-9_-]*):( .+)","i"),single_key_value:RegExp("^([a-z0-9_-][ a-z0-9_-]*):( .+?)$","i"),key:RegExp("([a-z0-9_-][ a-z0-9_-]+):( .+)?","i"),item:RegExp("^-\\s+"),trim:RegExp("^\\s+|\\s+$"),comment:RegExp("([^\\'\\\"#]+([\\'\\\"][^\\'\\\"]*[\\'\\\"])*)*(#.*)?")};function l(e){return{parent:null,length:0,level:e,lines:[],children:[],addChild:function(e){this.children.push(e),e.parent=this,++this.length}}}function a(e,t){var s=createXMLHTTPRequest();s.onreadystatechange=function(){if(4==this.readyState||200==this.status){var e=this.responseText;t(YAML.eval0(e))}},s.open("GET",e),s.send()}function n(t){var s,a=r.regLevel,n=r.invalidLine,o=t.split("\n"),p=0,f=0,u=[],c=new l(-1),_=new l(0);c.addChild(_);var d=[],$="";u.push(_),d.push(p);for(var h=0,g=o.length;h<g;++h)if(!($=o[h]).match(n)){if((p=(s=a.exec($))?s[1].length:0)>f){var m=_;_=new l(p),m.addChild(_),u.push(_),d.push(p)}else if(p<f){for(var x=!1,v=d.length-1;v>=0;--v)if(d[v]==p){_=new l(p),u.push(_),d.push(p),null!=u[v].parent&&u[v].parent.addChild(_),x=!0;break}if(!x){e.push("Error: Invalid indentation at line "+h+": "+$);return}}_.lines.push($.replace(r.trim,"")),f=p}return c}function o(e){e=e.replace(r.trim,"");var t=null;if("true"==e)return!0;if("false"==e)return!1;if(".NaN"==e)return Number.NaN;if("null"==e)return null;if(".inf"==e)return Number.POSITIVE_INFINITY;else if("-.inf"==e)return Number.NEGATIVE_INFINITY;else if(t=e.match(r.dashesString))return t[1];else if(t=e.match(r.quotesString))return t[1];else if(t=e.match(r.float))return parseFloat(t[0]);else if(t=e.match(r.integer))return parseInt(t[0]);else if(!isNaN(t=Date.parse(e)))return new Date(t);else if(t=e.match(r.single_key_value)){var s={};return s[t[1]]=o(t[2]),s}else if(t=e.match(r.array)){for(var l=0,a=" ",s=[],n="",p=!1,f=0,u=t[1].length;f<u;++f){if("'"==(a=t[1][f])||'"'==a){if(!1===p){p=a,n+=a;continue}if("'"==a&&"'"==p||'"'==a&&'"'==p){p=!1,n+=a;continue}}else if(!1===p&&("["==a||"{"==a))++l;else if(!1===p&&("]"==a||"}"==a))--l;else if(!1===p&&0==l&&","==a){s.push(o(n)),n="";continue}n+=a}return n.length>0&&s.push(o(n)),s}else{if(!(t=e.match(r.map)))return e;for(var l=0,a=" ",s=[],n="",p=!1,f=0,u=t[1].length;f<u;++f){if("'"==(a=t[1][f])||'"'==a){if(!1===p){p=a,n+=a;continue}if("'"==a&&"'"==p||'"'==a&&'"'==p){p=!1,n+=a;continue}}else if(!1===p&&("["==a||"{"==a))++l;else if(!1===p&&("]"==a||"}"==a))--l;else if(!1===p&&0==l&&","==a){s.push(n),n="";continue}n+=a}n.length>0&&s.push(n);for(var c={},f=0,u=s.length;f<u;++f)(t=s[f].match(r.key_value))&&(c[t[1]]=o(t[2]));return c}}function p(e){for(var t=e.lines,s=e.children,r=[t.join(" ")],l=0,a=s.length;l<a;++l)r.push(p(s[l]));return r.join("\n")}function f(e){for(var t=e.lines,s=e.children,r=t.join("\n"),l=0,a=s.length;l<a;++l)r+=f(s[l]);return r}function u(s){for(var l=null,a={},n=null,c=null,_=null,d=-1,$=[],h=!0,g=0,m=s.length;g<m;++g)if(-1==d||d==s[g].level){$.push(g),d=s[g].level,n=s[g].lines,c=s[g].children,_=null;for(var x=0,v=n.length;x<v;++x){var O=n[x];if(l=O.match(r.key)){var P=l[1];if("-"==P[0]&&(P=P.replace(r.item,""),h&&(h=!1,void 0===a.length&&(a=[])),null!=_&&a.push(_),_={},h=!0),void 0!==l[2]){var y=l[2].replace(r.trim,"");if("&"==y[0]){var b=u(c);null!=_?_[P]=b:a[P]=b,t[y.substr(1)]=b}else if("|"==y[0])null!=_?_[P]=f(c.shift()):a[P]=f(c.shift());else if("*"==y[0]){var k=y.substr(1),w={};if(void 0===t[k])e.push("Reference '"+k+"' not found!");else{for(var S in t[k])w[S]=t[k][S];null!=_?_[P]=w:a[P]=w}}else">"==y[0]?null!=_?_[P]=p(c.shift()):a[P]=p(c.shift()):null!=_?_[P]=o(y):a[P]=o(y)}else null!=_?_[P]=u(c):a[P]=u(c)}else if(O.match(/^-\s*$/)){h&&(h=!1,void 0===a.length&&(a=[])),null!=_&&a.push(_),_={},h=!0;continue}else if(l=O.match(/^-\s*(.*)/)){null!=_?_.push(o(l[1])):(h&&(h=!1,void 0===a.length&&(a=[])),a.push(o(l[1])));continue}}null!=_&&(h&&(h=!1,void 0===a.length&&(a=[])),a.push(_))}for(var g=$.length-1;g>=0;--g)s.splice.call(s,$[g],1);return a}function c(e){return u(e.children)}function _(e){var t,s=e.split("\n"),l=r.comment;for(var a in s)(t=s[a].match(l))&&void 0!==t[3]&&(s[a]=t[0].substr(0,t[0].length-t[3].length));return s.join("\n")}this.parse=function r(l){e=[],t=[],s=new Date().getTime();var a=_(l),o=n(a),p=c(o);return s=new Date().getTime()-s,p}}function Tools(){let e=(e,...t)=>{let s=[...Array(e.length).keys()].map(()=>!1);return t.reduce((t,s)=>OR(t,e.map(e=>s.test(e))),s)},t={replace:(e,t,s)=>e.map(e=>e.replace(t,s)),delete:(e,...t)=>e.map(e=>t.reduce((e,t)=>e.replace(t,""),e)),trim:e=>e.map(e=>e.trim().replace(/[^\S\r\n]{2,}/g," "))},s=e=>{let t={names:e.map(e=>e.split("tag=")[1]),types:e.map(e=>{let t=e.match(/^(vmess|trojan|shadowsocks|http)=/);return t?t[1]:"unknown"})};return t};return{filter:e,rename:t,getNodeInfo:s}}function AND(...e){return e.reduce((e,t)=>e.map((e,s)=>t[s]&&e))}function OR(...e){return e.reduce((e,t)=>e.map((e,s)=>t[s]||e))}function NOT(e){return e.map(e=>!e)}
